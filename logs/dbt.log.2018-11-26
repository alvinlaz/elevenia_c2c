2018-11-26 11:23:10,078 (MainThread): Tracking: do not track
2018-11-26 11:23:10,084 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 11:23:10,092 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 11:23:10,104 (MainThread): Parsing macros\core.sql
2018-11-26 11:23:10,116 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 11:23:10,123 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 11:23:10,138 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 11:23:10,148 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 11:23:10,153 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 11:23:10,160 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 11:23:10,170 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 11:23:10,175 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 11:23:10,180 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 11:23:10,191 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 11:23:10,198 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 11:23:10,208 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 11:23:10,235 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 11:23:10,244 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 11:23:10,253 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 11:23:10,266 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 11:23:10,271 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 11:23:10,289 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 11:23:10,301 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 11:23:10,314 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 11:23:10,326 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 11:23:10,338 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 11:23:10,349 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 11:23:10,352 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 11:23:10,356 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 11:23:10,362 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 11:23:10,366 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 11:23:10,370 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 11:23:10,374 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 11:23:10,379 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 11:23:10,385 (MainThread): Parsing macros\core.sql
2018-11-26 11:23:10,389 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 11:23:10,392 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 11:23:10,401 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 11:23:10,406 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 11:23:10,408 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 11:23:10,409 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 11:23:10,415 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 11:23:10,417 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 11:23:10,417 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 11:23:10,424 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 11:23:10,426 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 11:23:10,432 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 11:23:10,453 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 11:23:10,456 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 11:23:10,463 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 11:23:10,472 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 11:23:10,474 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 11:23:10,487 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 11:23:10,496 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 11:23:10,504 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 11:23:10,513 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 11:23:10,520 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 11:23:10,527 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 11:23:10,529 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 11:23:10,530 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 11:23:10,531 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 11:23:10,532 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 11:23:10,534 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 11:23:10,535 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 11:23:10,536 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 11:23:10,578 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 11:23:10,595 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 11:23:10,605 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 11:23:10,617 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 11:23:10,629 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 11:23:10,641 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 11:23:10,654 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:23:10,654 (MainThread): Acquiring new redshift connection "master".
2018-11-26 11:23:10,654 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 11:23:10,655 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 11:23:11,513 (MainThread): Using redshift connection "master".
2018-11-26 11:23:11,514 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:23:11,612 (MainThread): SQL status: SELECT in 0.10 seconds
2018-11-26 11:23:11,613 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:23:11,614 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 11:23:11,627 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:23:11,627 (MainThread): Using redshift connection "master".
2018-11-26 11:23:11,627 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:23:11,687 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 11:23:11,688 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:23:11,690 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 11:23:11,703 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:23:11,703 (MainThread): Using redshift connection "master".
2018-11-26 11:23:11,703 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:23:11,764 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 11:23:11,765 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:23:11,766 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 11:23:11,778 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:23:11,778 (MainThread): Using redshift connection "master".
2018-11-26 11:23:11,778 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:23:11,842 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 11:23:11,843 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:23:11,845 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 11:23:11,857 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:23:11,857 (MainThread): Using redshift connection "master".
2018-11-26 11:23:11,857 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:23:11,917 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 11:23:11,918 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:23:11,919 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 11:23:11,931 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:23:11,932 (MainThread): Using redshift connection "master".
2018-11-26 11:23:11,932 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:23:12,008 (MainThread): SQL status: SELECT in 0.08 seconds
2018-11-26 11:23:12,010 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:23:12,011 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 11:23:12,022 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 11:23:12,035 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 11:23:12,048 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 11:23:12,060 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 11:23:12,071 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 11:23:12,122 (MainThread): Found 2 operations, 0 analyses, 94 macros, 17 models, 0 tests, 0 seed files, 0 archives
2018-11-26 11:23:12,123 (MainThread): 
2018-11-26 11:23:12,123 (MainThread): Using redshift connection "master".
2018-11-26 11:23:12,123 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:23:12,179 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 11:23:12,215 (MainThread): Acquiring new redshift connection "get_relations_data".
2018-11-26 11:23:12,215 (MainThread): Opening a new connection (1 currently allocated)
2018-11-26 11:23:12,215 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 11:23:12,347 (MainThread): Using redshift connection "get_relations_data".
2018-11-26 11:23:12,348 (MainThread): On get_relations_data: BEGIN
2018-11-26 11:23:12,391 (MainThread): SQL status: BEGIN in 0.04 seconds
2018-11-26 11:23:12,391 (MainThread): Using redshift connection "get_relations_data".
2018-11-26 11:23:12,391 (MainThread): On get_relations_data: -- 
    with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg_%'
    ),
    relationships as (
        select
            referenced_class.name as referenced_name,
            referenced_class.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced_class.kind as kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        join dependency on relation.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            referenced_class.kind in ('r', 'v') and
            (referenced_class.name != dependent_class.name or
             referenced_class.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2018-11-26 11:23:12,494 (MainThread): SQL status: SELECT in 0.10 seconds
2018-11-26 11:23:12,503 (MainThread): On get_relations_data: ROLLBACK
2018-11-26 11:23:12,522 (MainThread): Using redshift connection "master".
2018-11-26 11:23:12,522 (MainThread): On master: select distinct nspname from pg_namespace
2018-11-26 11:23:12,541 (MainThread): SQL status: SELECT in 0.02 seconds
2018-11-26 11:23:12,541 (MainThread): 11:23:12 | Concurrency: 1 threads (target='dev')
2018-11-26 11:23:12,541 (MainThread): 11:23:12 | 
2018-11-26 11:23:12,544 (Thread-1): 11:23:12 | 1 of 1 START view model dbt_dev.ord_no_hr_paid....................... [RUN]
2018-11-26 11:23:12,545 (Thread-1): Compiling model.elevenia_c2c.ord_no_hr_paid
2018-11-26 11:23:12,549 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_no_hr_paid"
2018-11-26 11:23:12,578 (Thread-1): Acquiring new redshift connection "ord_no_hr_paid".
2018-11-26 11:23:12,578 (Thread-1): Re-using an available connection from the pool.
2018-11-26 11:23:12,579 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:23:12,579 (Thread-1): On ord_no_hr_paid: BEGIN
2018-11-26 11:23:12,613 (Thread-1): SQL status: BEGIN in 0.03 seconds
2018-11-26 11:23:12,613 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:23:12,613 (Thread-1): On ord_no_hr_paid: drop view if exists "dbt_dev"."ord_no_hr_paid__dbt_tmp" cascade
2018-11-26 11:23:12,631 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2018-11-26 11:23:12,631 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:23:12,631 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:23:12,631 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:23:13,423 (Thread-1): SQL status: COMMIT in 0.79 seconds
2018-11-26 11:23:13,423 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:23:13,423 (Thread-1): On ord_no_hr_paid: BEGIN
2018-11-26 11:23:13,441 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 11:23:13,441 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:23:13,441 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:23:13,441 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:23:13,464 (Thread-1): SQL status: COMMIT in 0.02 seconds
2018-11-26 11:23:13,464 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:23:13,464 (Thread-1): On ord_no_hr_paid: BEGIN
2018-11-26 11:23:13,490 (Thread-1): SQL status: BEGIN in 0.03 seconds
2018-11-26 11:23:13,491 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:23:13,491 (Thread-1): On ord_no_hr_paid: drop view if exists "dbt_dev"."ord_no_hr_paid__dbt_backup" cascade
2018-11-26 11:23:13,532 (Thread-1): SQL status: DROP VIEW in 0.04 seconds
2018-11-26 11:23:13,533 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:23:13,533 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:23:13,533 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:23:15,767 (Thread-1): SQL status: COMMIT in 2.23 seconds
2018-11-26 11:23:15,768 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:23:15,768 (Thread-1): On ord_no_hr_paid: BEGIN
2018-11-26 11:23:15,785 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 11:23:15,799 (Thread-1): Writing runtime SQL for node "model.elevenia_c2c.ord_no_hr_paid"
2018-11-26 11:23:15,800 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:23:15,800 (Thread-1): On ord_no_hr_paid: 

  create view "dbt_dev"."ord_no_hr_paid__dbt_tmp" as (
    SELECT to_char(ord_stl_end_dt,'YYYYMMDD-HH24') ord_stl_end_dy_conc_hr
, dateadd(hour,7,getdate()) created_dt
, max(case when ord_stl_end_dt is not null then ord_no end) ord_no_max
from dwuser.sd_sales_dtls t1
where to_char(ord_stl_end_dt,'YYYYMMDD-HH24') >= 'to_char(dateadd(hour,7,getdate()),'YYYYMMDD-HH24')'
group by 1
order by 1 desc
  ) ;
2018-11-26 11:23:15,817 (Thread-1): Postgres error: syntax error at or near "YYYYMMDD"
LINE 8: ...MDD-HH24') >= 'to_char(dateadd(hour,7,getdate()),'YYYYMMDD-H...
                                                             ^

2018-11-26 11:23:15,818 (Thread-1): On ord_no_hr_paid: ROLLBACK
2018-11-26 11:23:15,838 (Thread-1): 11:23:15 | 1 of 1 ERROR creating view model dbt_dev.ord_no_hr_paid.............. [ERROR in 3.29s]
2018-11-26 11:23:15,867 (MainThread): 11:23:15 | 
2018-11-26 11:23:15,867 (MainThread): 11:23:15 | Finished running 1 view models in 3.74s.
2018-11-26 11:23:15,868 (MainThread): Connection 'master' was left open.
2018-11-26 11:23:15,870 (MainThread): 
2018-11-26 11:23:15,871 (MainThread): Completed with 1 errors:
2018-11-26 11:23:15,871 (MainThread): 
2018-11-26 11:23:15,871 (MainThread): Database Error in model ord_no_hr_paid (models\incremental_table\ord_no_hr_paid.sql)
2018-11-26 11:23:15,872 (MainThread):   syntax error at or near "YYYYMMDD"
2018-11-26 11:23:15,872 (MainThread):   LINE 8: ...MDD-HH24') >= 'to_char(dateadd(hour,7,getdate()),'YYYYMMDD-H...
2018-11-26 11:23:15,873 (MainThread):                                                                ^
2018-11-26 11:23:15,873 (MainThread):   compiled SQL at target\compiled\elevenia_c2c\incremental_table\ord_no_hr_paid.sql
2018-11-26 11:23:15,873 (MainThread): 
Done. PASS=0 ERROR=1 SKIP=0 TOTAL=1
2018-11-26 11:23:15,874 (MainThread): Flushing usage events
2018-11-26 11:24:47,617 (MainThread): Tracking: do not track
2018-11-26 11:24:47,617 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 11:24:47,622 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 11:24:47,627 (MainThread): Parsing macros\core.sql
2018-11-26 11:24:47,631 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 11:24:47,635 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 11:24:47,646 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 11:24:47,653 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 11:24:47,655 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 11:24:47,656 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 11:24:47,664 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 11:24:47,665 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 11:24:47,666 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 11:24:47,674 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 11:24:47,677 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 11:24:47,684 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 11:24:47,709 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 11:24:47,714 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 11:24:47,719 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 11:24:47,729 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 11:24:47,732 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 11:24:47,746 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 11:24:47,754 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 11:24:47,763 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 11:24:47,772 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 11:24:47,781 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 11:24:47,788 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 11:24:47,789 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 11:24:47,790 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 11:24:47,793 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 11:24:47,794 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 11:24:47,796 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 11:24:47,797 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 11:24:47,799 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 11:24:47,804 (MainThread): Parsing macros\core.sql
2018-11-26 11:24:47,809 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 11:24:47,813 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 11:24:47,821 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 11:24:47,828 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 11:24:47,830 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 11:24:47,831 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 11:24:47,837 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 11:24:47,839 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 11:24:47,840 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 11:24:47,847 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 11:24:47,849 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 11:24:47,854 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 11:24:47,877 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 11:24:47,880 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 11:24:47,885 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 11:24:47,894 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 11:24:47,896 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 11:24:47,908 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 11:24:47,917 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 11:24:47,926 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 11:24:47,934 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 11:24:47,942 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 11:24:47,949 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 11:24:47,950 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 11:24:47,951 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 11:24:47,953 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 11:24:47,953 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 11:24:47,955 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 11:24:47,956 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 11:24:47,957 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 11:24:47,966 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 11:24:47,982 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 11:24:47,993 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 11:24:48,006 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 11:24:48,017 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 11:24:48,029 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 11:24:48,041 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:24:48,042 (MainThread): Acquiring new redshift connection "master".
2018-11-26 11:24:48,042 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 11:24:48,043 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 11:24:48,919 (MainThread): Using redshift connection "master".
2018-11-26 11:24:48,919 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:24:49,638 (MainThread): SQL status: SELECT in 0.72 seconds
2018-11-26 11:24:49,640 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:24:49,641 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 11:24:49,653 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:24:49,653 (MainThread): Using redshift connection "master".
2018-11-26 11:24:49,653 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:24:50,137 (MainThread): SQL status: SELECT in 0.48 seconds
2018-11-26 11:24:50,139 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:24:50,143 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 11:24:50,166 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:24:50,166 (MainThread): Using redshift connection "master".
2018-11-26 11:24:50,166 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:24:50,627 (MainThread): SQL status: SELECT in 0.46 seconds
2018-11-26 11:24:50,629 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:24:50,630 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 11:24:50,640 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:24:50,640 (MainThread): Using redshift connection "master".
2018-11-26 11:24:50,640 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:24:50,890 (MainThread): SQL status: SELECT in 0.25 seconds
2018-11-26 11:24:50,892 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:24:50,893 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 11:24:50,904 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:24:50,904 (MainThread): Using redshift connection "master".
2018-11-26 11:24:50,905 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:24:51,421 (MainThread): SQL status: SELECT in 0.52 seconds
2018-11-26 11:24:51,422 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:24:51,424 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 11:24:51,435 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:24:51,435 (MainThread): Using redshift connection "master".
2018-11-26 11:24:51,435 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:24:51,786 (MainThread): SQL status: SELECT in 0.35 seconds
2018-11-26 11:24:51,787 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:24:51,788 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 11:24:51,799 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 11:24:51,810 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 11:24:51,821 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 11:24:51,833 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 11:24:51,844 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 11:24:51,887 (MainThread): Found 0 seed files, 0 archives, 17 models, 94 macros, 0 tests, 2 operations, 0 analyses
2018-11-26 11:24:51,888 (MainThread): 
2018-11-26 11:24:51,888 (MainThread): Using redshift connection "master".
2018-11-26 11:24:51,888 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:24:52,422 (MainThread): SQL status: SELECT in 0.53 seconds
2018-11-26 11:24:52,456 (MainThread): Acquiring new redshift connection "get_relations_data".
2018-11-26 11:24:52,456 (MainThread): Opening a new connection (1 currently allocated)
2018-11-26 11:24:52,457 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 11:24:52,588 (MainThread): Using redshift connection "get_relations_data".
2018-11-26 11:24:52,588 (MainThread): On get_relations_data: BEGIN
2018-11-26 11:24:52,631 (MainThread): SQL status: BEGIN in 0.04 seconds
2018-11-26 11:24:52,631 (MainThread): Using redshift connection "get_relations_data".
2018-11-26 11:24:52,631 (MainThread): On get_relations_data: -- 
    with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg_%'
    ),
    relationships as (
        select
            referenced_class.name as referenced_name,
            referenced_class.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced_class.kind as kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        join dependency on relation.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            referenced_class.kind in ('r', 'v') and
            (referenced_class.name != dependent_class.name or
             referenced_class.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2018-11-26 11:24:53,866 (MainThread): SQL status: SELECT in 1.23 seconds
2018-11-26 11:24:53,876 (MainThread): On get_relations_data: ROLLBACK
2018-11-26 11:24:53,899 (MainThread): Using redshift connection "master".
2018-11-26 11:24:53,899 (MainThread): On master: select distinct nspname from pg_namespace
2018-11-26 11:24:53,931 (MainThread): SQL status: SELECT in 0.03 seconds
2018-11-26 11:24:53,931 (MainThread): 11:24:53 | Concurrency: 1 threads (target='dev')
2018-11-26 11:24:53,931 (MainThread): 11:24:53 | 
2018-11-26 11:24:53,933 (Thread-1): 11:24:53 | 1 of 1 START view model dbt_dev.ord_no_hr_paid....................... [RUN]
2018-11-26 11:24:53,934 (Thread-1): Compiling model.elevenia_c2c.ord_no_hr_paid
2018-11-26 11:24:53,939 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_no_hr_paid"
2018-11-26 11:24:53,970 (Thread-1): Acquiring new redshift connection "ord_no_hr_paid".
2018-11-26 11:24:53,971 (Thread-1): Re-using an available connection from the pool.
2018-11-26 11:24:53,971 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:24:53,971 (Thread-1): On ord_no_hr_paid: BEGIN
2018-11-26 11:24:54,010 (Thread-1): SQL status: BEGIN in 0.04 seconds
2018-11-26 11:24:54,010 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:24:54,011 (Thread-1): On ord_no_hr_paid: drop view if exists "dbt_dev"."ord_no_hr_paid__dbt_tmp" cascade
2018-11-26 11:24:54,030 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2018-11-26 11:24:54,030 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:24:54,030 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:24:54,030 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:24:56,948 (Thread-1): SQL status: COMMIT in 2.92 seconds
2018-11-26 11:24:56,949 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:24:56,949 (Thread-1): On ord_no_hr_paid: BEGIN
2018-11-26 11:24:56,973 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 11:24:56,974 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:24:56,974 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:24:56,974 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:24:56,992 (Thread-1): SQL status: COMMIT in 0.02 seconds
2018-11-26 11:24:56,993 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:24:56,993 (Thread-1): On ord_no_hr_paid: BEGIN
2018-11-26 11:24:57,013 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 11:24:57,013 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:24:57,013 (Thread-1): On ord_no_hr_paid: drop view if exists "dbt_dev"."ord_no_hr_paid__dbt_backup" cascade
2018-11-26 11:24:57,033 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2018-11-26 11:24:57,033 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:24:57,033 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:24:57,033 (Thread-1): On ord_no_hr_paid: COMMIT
2018-11-26 11:24:57,722 (Thread-1): SQL status: COMMIT in 0.69 seconds
2018-11-26 11:24:57,723 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:24:57,723 (Thread-1): On ord_no_hr_paid: BEGIN
2018-11-26 11:24:57,761 (Thread-1): SQL status: BEGIN in 0.04 seconds
2018-11-26 11:24:57,775 (Thread-1): Writing runtime SQL for node "model.elevenia_c2c.ord_no_hr_paid"
2018-11-26 11:24:57,776 (Thread-1): Using redshift connection "ord_no_hr_paid".
2018-11-26 11:24:57,776 (Thread-1): On ord_no_hr_paid: 

  create view "dbt_dev"."ord_no_hr_paid__dbt_tmp" as (
    SELECT to_char(ord_stl_end_dt,'YYYYMMDD-HH24') ord_stl_end_dy_conc_hr
, dateadd(hour,7,getdate()) created_dt
, max(case when ord_stl_end_dt is not null then ord_no end) ord_no_max
from dwuser.sd_sales_dtls t1
where to_char(ord_stl_end_dt,'YYYYMMDDHH24') >= 'to_char(dateadd(hour,7,getdate()),'YYYYMMDDHH24')'
group by 1
order by 1 desc
  ) ;
2018-11-26 11:24:57,796 (Thread-1): Postgres error: syntax error at or near "YYYYMMDDHH24"
LINE 8: ...MMDDHH24') >= 'to_char(dateadd(hour,7,getdate()),'YYYYMMDDHH...
                                                             ^

2018-11-26 11:24:57,797 (Thread-1): On ord_no_hr_paid: ROLLBACK
2018-11-26 11:24:57,818 (Thread-1): 11:24:57 | 1 of 1 ERROR creating view model dbt_dev.ord_no_hr_paid.............. [ERROR in 3.88s]
2018-11-26 11:24:57,861 (MainThread): 11:24:57 | 
2018-11-26 11:24:57,861 (MainThread): 11:24:57 | Finished running 1 view models in 5.97s.
2018-11-26 11:24:57,862 (MainThread): Connection 'master' was left open.
2018-11-26 11:24:57,864 (MainThread): 
2018-11-26 11:24:57,865 (MainThread): Completed with 1 errors:
2018-11-26 11:24:57,865 (MainThread): 
2018-11-26 11:24:57,865 (MainThread): Database Error in model ord_no_hr_paid (models\incremental_table\ord_no_hr_paid.sql)
2018-11-26 11:24:57,866 (MainThread):   syntax error at or near "YYYYMMDDHH24"
2018-11-26 11:24:57,866 (MainThread):   LINE 8: ...MMDDHH24') >= 'to_char(dateadd(hour,7,getdate()),'YYYYMMDDHH...
2018-11-26 11:24:57,866 (MainThread):                                                                ^
2018-11-26 11:24:57,867 (MainThread):   compiled SQL at target\compiled\elevenia_c2c\incremental_table\ord_no_hr_paid.sql
2018-11-26 11:24:57,867 (MainThread): 
Done. PASS=0 ERROR=1 SKIP=0 TOTAL=1
2018-11-26 11:24:57,867 (MainThread): Flushing usage events
2018-11-26 11:51:01,427 (MainThread): Tracking: do not track
2018-11-26 11:51:01,427 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 11:51:01,433 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 11:51:01,437 (MainThread): Parsing macros\core.sql
2018-11-26 11:51:01,442 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 11:51:01,447 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 11:51:01,458 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 11:51:01,465 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 11:51:01,467 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 11:51:01,468 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 11:51:01,475 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 11:51:01,477 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 11:51:01,478 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 11:51:01,486 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 11:51:01,488 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 11:51:01,495 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 11:51:01,520 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 11:51:01,524 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 11:51:01,530 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 11:51:01,539 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 11:51:01,542 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 11:51:01,560 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 11:51:01,570 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 11:51:01,579 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 11:51:01,587 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 11:51:01,596 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 11:51:01,605 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 11:51:01,606 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 11:51:01,607 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 11:51:01,609 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 11:51:01,612 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 11:51:01,615 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 11:51:01,615 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 11:51:01,617 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 11:51:01,622 (MainThread): Parsing macros\core.sql
2018-11-26 11:51:01,626 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 11:51:01,629 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 11:51:01,637 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 11:51:01,642 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 11:51:01,644 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 11:51:01,646 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 11:51:01,651 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 11:51:01,652 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 11:51:01,653 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 11:51:01,661 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 11:51:01,662 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 11:51:01,667 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 11:51:01,688 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 11:51:01,691 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 11:51:01,697 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 11:51:01,706 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 11:51:01,708 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 11:51:01,720 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 11:51:01,728 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 11:51:01,736 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 11:51:01,745 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 11:51:01,752 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 11:51:01,759 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 11:51:01,760 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 11:51:01,762 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 11:51:01,763 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 11:51:01,764 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 11:51:01,766 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 11:51:01,767 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 11:51:01,768 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 11:51:01,776 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 11:51:01,792 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 11:51:01,804 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 11:51:01,817 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 11:51:01,830 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 11:51:01,842 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 11:51:01,854 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:01,854 (MainThread): Acquiring new redshift connection "master".
2018-11-26 11:51:01,854 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 11:51:01,855 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 11:51:02,662 (MainThread): Using redshift connection "master".
2018-11-26 11:51:02,662 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:02,736 (MainThread): SQL status: SELECT in 0.07 seconds
2018-11-26 11:51:02,737 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:02,738 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 11:51:02,750 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:02,750 (MainThread): Using redshift connection "master".
2018-11-26 11:51:02,750 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:02,792 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:02,793 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:02,795 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 11:51:02,806 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:02,806 (MainThread): Using redshift connection "master".
2018-11-26 11:51:02,807 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:02,850 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:02,851 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:02,852 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 11:51:02,864 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:02,864 (MainThread): Using redshift connection "master".
2018-11-26 11:51:02,864 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:02,911 (MainThread): SQL status: SELECT in 0.05 seconds
2018-11-26 11:51:02,912 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:02,913 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 11:51:02,925 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:02,925 (MainThread): Using redshift connection "master".
2018-11-26 11:51:02,925 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:02,967 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:02,968 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:02,969 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 11:51:02,981 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:02,982 (MainThread): Using redshift connection "master".
2018-11-26 11:51:02,982 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:03,021 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:03,023 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:03,024 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 11:51:03,036 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 11:51:03,049 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 11:51:03,063 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 11:51:03,074 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 11:51:03,085 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 11:51:03,132 (MainThread): Found 0 tests, 2 operations, 0 analyses, 94 macros, 0 seed files, 17 models, 0 archives
2018-11-26 11:51:03,140 (MainThread): 
2018-11-26 11:51:03,141 (MainThread): 11:51:03 | Concurrency: 1 threads (target='dev')
2018-11-26 11:51:03,141 (MainThread): 11:51:03 | 
2018-11-26 11:51:03,144 (Thread-1): Compiling model.elevenia_c2c.ord_no_hr
2018-11-26 11:51:03,147 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_no_hr"
2018-11-26 11:51:03,149 (Thread-1): Compiling model.elevenia_c2c.paid_trx_hourly
2018-11-26 11:51:03,152 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.paid_trx_hourly"
2018-11-26 11:51:03,156 (Thread-1): Compiling model.elevenia_c2c.ff_free_delivery_d
2018-11-26 11:51:03,159 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ff_free_delivery_d"
2018-11-26 11:51:03,163 (Thread-1): Compiling model.elevenia_c2c.dd_disp_ctgr
2018-11-26 11:51:03,166 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_disp_ctgr"
2018-11-26 11:51:03,169 (Thread-1): Compiling model.elevenia_c2c.ord_trx_hourly
2018-11-26 11:51:03,172 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_trx_hourly"
2018-11-26 11:51:03,176 (Thread-1): Compiling model.elevenia_c2c.ord_no_hr_paid
2018-11-26 11:51:03,180 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_no_hr_paid"
2018-11-26 11:51:03,184 (Thread-1): Compiling model.elevenia_c2c.dd_address
2018-11-26 11:51:03,187 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_address"
2018-11-26 11:51:03,190 (Thread-1): Compiling model.elevenia_c2c.rangga_test
2018-11-26 11:51:03,193 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.rangga_test"
2018-11-26 11:51:03,197 (Thread-1): Compiling model.elevenia_c2c.xbi_1087_top_100
2018-11-26 11:51:03,200 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.xbi_1087_top_100"
2018-11-26 11:51:03,204 (Thread-1): Compiling model.elevenia_c2c.sessions_ord_test
2018-11-26 11:51:03,209 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:03,209 (Thread-1): Using redshift connection "master".
2018-11-26 11:51:03,209 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:03,252 (Thread-1): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:03,253 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:03,254 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_ord_test"
2018-11-26 11:51:03,257 (Thread-1): Compiling model.elevenia_c2c.dd_address_v3
2018-11-26 11:51:03,262 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_address_v3"
2018-11-26 11:51:03,265 (Thread-1): Compiling model.elevenia_c2c.sessions_paid
2018-11-26 11:51:03,270 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:03,270 (Thread-1): Using redshift connection "master".
2018-11-26 11:51:03,270 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:03,312 (Thread-1): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:03,313 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:03,314 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_paid"
2018-11-26 11:51:03,316 (Thread-1): Compiling model.elevenia_c2c.sessions_dlv
2018-11-26 11:51:03,320 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:03,320 (Thread-1): Using redshift connection "master".
2018-11-26 11:51:03,321 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:03,361 (Thread-1): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:03,363 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:03,364 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_dlv"
2018-11-26 11:51:03,367 (Thread-1): Compiling model.elevenia_c2c.sessions
2018-11-26 11:51:03,371 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:03,371 (Thread-1): Using redshift connection "master".
2018-11-26 11:51:03,371 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:03,414 (Thread-1): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:03,415 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:03,416 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions"
2018-11-26 11:51:03,418 (Thread-1): Compiling model.elevenia_c2c.sessions_paid_test
2018-11-26 11:51:03,422 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:03,422 (Thread-1): Using redshift connection "master".
2018-11-26 11:51:03,422 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:03,465 (Thread-1): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:03,469 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:03,471 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_paid_test"
2018-11-26 11:51:03,480 (Thread-1): Compiling model.elevenia_c2c.dd_address_v2
2018-11-26 11:51:03,489 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_address_v2"
2018-11-26 11:51:03,496 (Thread-1): Compiling model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 11:51:03,505 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:03,505 (Thread-1): Using redshift connection "master".
2018-11-26 11:51:03,506 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:03,550 (Thread-1): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:03,551 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:03,552 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_ord_no_hr"
2018-11-26 11:51:03,646 (MainThread): Connection 'master' was left open.
2018-11-26 11:51:03,663 (MainThread): 11:51:03 | Done.
2018-11-26 11:51:03,685 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 11:51:03,690 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 11:51:03,696 (MainThread): Parsing macros\core.sql
2018-11-26 11:51:03,701 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 11:51:03,705 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 11:51:03,717 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 11:51:03,723 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 11:51:03,726 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 11:51:03,728 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 11:51:03,735 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 11:51:03,736 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 11:51:03,737 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 11:51:03,747 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 11:51:03,749 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 11:51:03,756 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 11:51:03,781 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 11:51:03,785 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 11:51:03,790 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 11:51:03,800 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 11:51:03,802 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 11:51:03,817 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 11:51:03,825 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 11:51:03,834 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 11:51:03,842 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 11:51:03,851 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 11:51:03,857 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 11:51:03,858 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 11:51:03,859 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 11:51:03,861 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 11:51:03,863 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 11:51:03,865 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 11:51:03,866 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 11:51:03,867 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 11:51:03,873 (MainThread): Parsing macros\core.sql
2018-11-26 11:51:03,876 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 11:51:03,880 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 11:51:03,888 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 11:51:03,894 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 11:51:03,895 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 11:51:03,897 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 11:51:03,902 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 11:51:03,903 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 11:51:03,904 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 11:51:03,912 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 11:51:03,914 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 11:51:03,918 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 11:51:03,938 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 11:51:03,942 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 11:51:03,947 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 11:51:03,956 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 11:51:03,958 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 11:51:03,971 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 11:51:03,979 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 11:51:03,988 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 11:51:03,995 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 11:51:04,003 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 11:51:04,009 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 11:51:04,011 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 11:51:04,012 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 11:51:04,014 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 11:51:04,015 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 11:51:04,016 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 11:51:04,017 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 11:51:04,019 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 11:51:04,029 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 11:51:04,042 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 11:51:04,054 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 11:51:04,065 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 11:51:04,076 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 11:51:04,087 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 11:51:04,099 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:04,099 (MainThread): Acquiring new redshift connection "master".
2018-11-26 11:51:04,099 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 11:51:04,100 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 11:51:04,233 (MainThread): Using redshift connection "master".
2018-11-26 11:51:04,233 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:04,308 (MainThread): SQL status: SELECT in 0.08 seconds
2018-11-26 11:51:04,310 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:04,311 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 11:51:04,322 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:04,322 (MainThread): Using redshift connection "master".
2018-11-26 11:51:04,322 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:04,363 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:04,364 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:04,366 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 11:51:04,378 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:04,378 (MainThread): Using redshift connection "master".
2018-11-26 11:51:04,378 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:04,423 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:04,424 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:04,425 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 11:51:04,437 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:04,437 (MainThread): Using redshift connection "master".
2018-11-26 11:51:04,437 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:04,480 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:04,482 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:04,483 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 11:51:04,495 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:04,495 (MainThread): Using redshift connection "master".
2018-11-26 11:51:04,495 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:04,537 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:04,538 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:04,539 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 11:51:04,551 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 11:51:04,551 (MainThread): Using redshift connection "master".
2018-11-26 11:51:04,551 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 11:51:04,593 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 11:51:04,594 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 11:51:04,595 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 11:51:04,606 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 11:51:04,617 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 11:51:04,629 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 11:51:04,639 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 11:51:04,650 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 11:51:04,684 (MainThread): 11:51:04 | Building catalog
2018-11-26 11:51:04,726 (MainThread): Acquiring new redshift connection "get_catalog_data".
2018-11-26 11:51:04,726 (MainThread): Opening a new connection (1 currently allocated)
2018-11-26 11:51:04,727 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 11:51:04,857 (MainThread): Using redshift connection "get_catalog_data".
2018-11-26 11:51:04,857 (MainThread): On get_catalog_data: BEGIN
2018-11-26 11:51:04,890 (MainThread): SQL status: BEGIN in 0.03 seconds
2018-11-26 11:51:04,891 (MainThread): Using redshift connection "get_catalog_data".
2018-11-26 11:51:04,891 (MainThread): On get_catalog_data: with late_binding as (
      select
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    tables as (

      select
          table_schema,
          table_name,
          table_type

      from information_schema.tables

    ),

    table_owners as (

        select
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    columns as (

        select
            table_schema,
            table_name,
            null::varchar as table_comment,

            column_name,
            ordinal_position as column_index,
            data_type as column_type,
            null::varchar as column_comment


        from information_schema.columns

    ),

    unioned as (

        select *
        from tables
        join columns using (table_schema, table_name)

        union all

        select *
        from late_binding

    )

    select *,
        table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_schema, table_name)

    where table_schema != 'information_schema'
      and table_schema not like 'pg_%'

    order by "column_index"
2018-11-26 11:51:05,748 (MainThread): SQL status: SELECT in 0.86 seconds
2018-11-26 11:51:07,527 (MainThread): Using redshift connection "get_catalog_data".
2018-11-26 11:51:07,527 (MainThread): On get_catalog_data: select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
2018-11-26 11:51:07,545 (MainThread): SQL status: SELECT in 0.02 seconds
2018-11-26 11:51:07,545 (MainThread): 

    Warning: The database user "dbt_user" has insufficient permissions to
    query the "svv_table_info" table. Please grant SELECT permissions on this table
    to the "dbt_user" user to fetch extended table details from Redshift.

    
2018-11-26 11:51:07,797 (MainThread): On get_catalog_data: ROLLBACK
2018-11-26 11:51:07,982 (MainThread): 11:51:07 | Catalog written to D:\project\elevenia_c2c\target\catalog.json
2018-11-26 11:51:07,982 (MainThread): Flushing usage events
2018-11-26 11:51:17,525 (MainThread): Tracking: do not track
2018-11-26 11:51:17,528 (MainThread): Serving docs at 0.0.0.0:8080
2018-11-26 11:51:17,528 (MainThread): To access from your browser, navigate to http://localhost:8080.
2018-11-26 11:51:17,528 (MainThread): Press Ctrl+C to exit.


2018-11-26 11:59:49,606 (MainThread): Flushing usage events
2018-11-26 11:59:49,606 (MainThread): ctrl-c
2018-11-26 12:04:20,862 (MainThread): Tracking: do not track
2018-11-26 12:04:20,862 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 12:04:20,867 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 12:04:20,872 (MainThread): Parsing macros\core.sql
2018-11-26 12:04:20,877 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:04:20,881 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:04:20,892 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:04:20,899 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:04:20,901 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:04:20,902 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:04:20,909 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:04:20,910 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:04:20,912 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:04:20,918 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:04:20,921 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:04:20,928 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:04:20,952 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:04:20,956 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:04:20,963 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:04:20,973 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:04:20,975 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:04:20,990 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:04:20,999 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:04:21,007 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:04:21,016 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:04:21,024 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:04:21,032 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:04:21,033 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:04:21,034 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:04:21,035 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:04:21,036 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:04:21,038 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:04:21,039 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:04:21,041 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:04:21,047 (MainThread): Parsing macros\core.sql
2018-11-26 12:04:21,051 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:04:21,054 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:04:21,063 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:04:21,068 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:04:21,070 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:04:21,071 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:04:21,079 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:04:21,081 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:04:21,083 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:04:21,089 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:04:21,091 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:04:21,097 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:04:21,117 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:04:21,121 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:04:21,126 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:04:21,135 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:04:21,137 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:04:21,150 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:04:21,158 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:04:21,167 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:04:21,175 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:04:21,182 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:04:21,189 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:04:21,190 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:04:21,191 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:04:21,192 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:04:21,193 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:04:21,195 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:04:21,196 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:04:21,198 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:04:21,206 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 12:04:21,221 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 12:04:21,232 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 12:04:21,244 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 12:04:21,255 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 12:04:21,267 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 12:04:21,279 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:21,279 (MainThread): Acquiring new redshift connection "master".
2018-11-26 12:04:21,279 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 12:04:21,280 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:04:22,080 (MainThread): Using redshift connection "master".
2018-11-26 12:04:22,081 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:22,181 (MainThread): SQL status: SELECT in 0.10 seconds
2018-11-26 12:04:22,182 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:04:22,183 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 12:04:22,194 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:22,195 (MainThread): Using redshift connection "master".
2018-11-26 12:04:22,195 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:22,266 (MainThread): SQL status: SELECT in 0.07 seconds
2018-11-26 12:04:22,267 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:04:22,268 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 12:04:22,280 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:22,280 (MainThread): Using redshift connection "master".
2018-11-26 12:04:22,280 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:22,360 (MainThread): SQL status: SELECT in 0.08 seconds
2018-11-26 12:04:22,361 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:04:22,363 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 12:04:22,374 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:22,374 (MainThread): Using redshift connection "master".
2018-11-26 12:04:22,374 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:22,464 (MainThread): SQL status: SELECT in 0.09 seconds
2018-11-26 12:04:22,465 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:04:22,466 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 12:04:22,477 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:22,477 (MainThread): Using redshift connection "master".
2018-11-26 12:04:22,477 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:22,544 (MainThread): SQL status: SELECT in 0.07 seconds
2018-11-26 12:04:22,545 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:04:22,547 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 12:04:22,558 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:22,558 (MainThread): Using redshift connection "master".
2018-11-26 12:04:22,558 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:22,657 (MainThread): SQL status: SELECT in 0.10 seconds
2018-11-26 12:04:22,658 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:04:22,659 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 12:04:22,670 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 12:04:22,681 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 12:04:22,692 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 12:04:22,703 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 12:04:22,714 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 12:04:22,757 (MainThread): Found 0 analyses, 0 seed files, 2 operations, 17 models, 94 macros, 0 tests, 0 archives
2018-11-26 12:04:22,759 (MainThread): 
2018-11-26 12:04:22,759 (MainThread): Using redshift connection "master".
2018-11-26 12:04:22,759 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:22,805 (MainThread): SQL status: SELECT in 0.05 seconds
2018-11-26 12:04:22,839 (MainThread): Acquiring new redshift connection "get_relations_data".
2018-11-26 12:04:22,839 (MainThread): Opening a new connection (1 currently allocated)
2018-11-26 12:04:22,840 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:04:22,965 (MainThread): Using redshift connection "get_relations_data".
2018-11-26 12:04:22,965 (MainThread): On get_relations_data: BEGIN
2018-11-26 12:04:23,000 (MainThread): SQL status: BEGIN in 0.03 seconds
2018-11-26 12:04:23,000 (MainThread): Using redshift connection "get_relations_data".
2018-11-26 12:04:23,001 (MainThread): On get_relations_data: -- 
    with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg_%'
    ),
    relationships as (
        select
            referenced_class.name as referenced_name,
            referenced_class.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced_class.kind as kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        join dependency on relation.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            referenced_class.kind in ('r', 'v') and
            (referenced_class.name != dependent_class.name or
             referenced_class.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2018-11-26 12:04:23,092 (MainThread): SQL status: SELECT in 0.09 seconds
2018-11-26 12:04:23,101 (MainThread): On get_relations_data: ROLLBACK
2018-11-26 12:04:23,122 (MainThread): Using redshift connection "master".
2018-11-26 12:04:23,122 (MainThread): On master: select distinct nspname from pg_namespace
2018-11-26 12:04:23,140 (MainThread): SQL status: SELECT in 0.02 seconds
2018-11-26 12:04:23,141 (MainThread): 12:04:23 | Concurrency: 1 threads (target='dev')
2018-11-26 12:04:23,141 (MainThread): 12:04:23 | 
2018-11-26 12:04:23,143 (Thread-1): 12:04:23 | 1 of 1 START view model dbt_dev.ff_free_delivery_d................... [RUN]
2018-11-26 12:04:23,144 (Thread-1): Compiling model.elevenia_c2c.ff_free_delivery_d
2018-11-26 12:04:23,148 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ff_free_delivery_d"
2018-11-26 12:04:23,175 (Thread-1): Acquiring new redshift connection "ff_free_delivery_d".
2018-11-26 12:04:23,175 (Thread-1): Re-using an available connection from the pool.
2018-11-26 12:04:23,175 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:23,175 (Thread-1): On ff_free_delivery_d: BEGIN
2018-11-26 12:04:23,210 (Thread-1): SQL status: BEGIN in 0.03 seconds
2018-11-26 12:04:23,211 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:23,211 (Thread-1): On ff_free_delivery_d: drop view if exists "dbt_dev"."ff_free_delivery_d__dbt_tmp" cascade
2018-11-26 12:04:23,229 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2018-11-26 12:04:23,229 (Thread-1): On ff_free_delivery_d: COMMIT
2018-11-26 12:04:23,229 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:23,229 (Thread-1): On ff_free_delivery_d: COMMIT
2018-11-26 12:04:25,015 (Thread-1): SQL status: COMMIT in 1.79 seconds
2018-11-26 12:04:25,016 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:25,016 (Thread-1): On ff_free_delivery_d: BEGIN
2018-11-26 12:04:25,034 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 12:04:25,035 (Thread-1): On ff_free_delivery_d: COMMIT
2018-11-26 12:04:25,035 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:25,035 (Thread-1): On ff_free_delivery_d: COMMIT
2018-11-26 12:04:25,052 (Thread-1): SQL status: COMMIT in 0.02 seconds
2018-11-26 12:04:25,052 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:25,052 (Thread-1): On ff_free_delivery_d: BEGIN
2018-11-26 12:04:25,071 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 12:04:25,071 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:25,071 (Thread-1): On ff_free_delivery_d: drop view if exists "dbt_dev"."ff_free_delivery_d__dbt_backup" cascade
2018-11-26 12:04:25,089 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2018-11-26 12:04:25,089 (Thread-1): On ff_free_delivery_d: COMMIT
2018-11-26 12:04:25,089 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:25,089 (Thread-1): On ff_free_delivery_d: COMMIT
2018-11-26 12:04:25,604 (Thread-1): SQL status: COMMIT in 0.51 seconds
2018-11-26 12:04:25,604 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:25,604 (Thread-1): On ff_free_delivery_d: BEGIN
2018-11-26 12:04:25,623 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 12:04:25,636 (Thread-1): Writing runtime SQL for node "model.elevenia_c2c.ff_free_delivery_d"
2018-11-26 12:04:25,637 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:25,637 (Thread-1): On ff_free_delivery_d: 

  create view "dbt_dev"."ff_free_delivery_d__dbt_tmp" as (
    select trunc(load_dt) load_dt
, basic_dd
, paid_gmv
, dateadd(hour,7,getdate()) created_dt
from DWUSER.FF_FREE_DELIVERY 
where basic_dd = to_char(dateadd(day,-1,getdate()),'YYYYMMDD')
  ) ;
2018-11-26 12:04:25,675 (Thread-1): SQL status: CREATE VIEW in 0.04 seconds
2018-11-26 12:04:25,677 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:25,678 (Thread-1): On ff_free_delivery_d: alter table "dbt_dev"."ff_free_delivery_d" rename to "ff_free_delivery_d__dbt_backup"
2018-11-26 12:04:25,696 (Thread-1): SQL status: ALTER TABLE in 0.02 seconds
2018-11-26 12:04:25,697 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:25,697 (Thread-1): On ff_free_delivery_d: alter table "dbt_dev"."ff_free_delivery_d__dbt_tmp" rename to "ff_free_delivery_d"
2018-11-26 12:04:25,715 (Thread-1): SQL status: ALTER TABLE in 0.02 seconds
2018-11-26 12:04:25,716 (Thread-1): On ff_free_delivery_d: COMMIT
2018-11-26 12:04:25,716 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:25,716 (Thread-1): On ff_free_delivery_d: COMMIT
2018-11-26 12:04:26,206 (Thread-1): SQL status: COMMIT in 0.49 seconds
2018-11-26 12:04:26,206 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:26,206 (Thread-1): On ff_free_delivery_d: BEGIN
2018-11-26 12:04:26,225 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 12:04:26,225 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:26,225 (Thread-1): On ff_free_delivery_d: drop view if exists "dbt_dev"."ff_free_delivery_d__dbt_backup" cascade
2018-11-26 12:04:26,249 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2018-11-26 12:04:26,249 (Thread-1): On ff_free_delivery_d: COMMIT
2018-11-26 12:04:26,249 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:26,249 (Thread-1): On ff_free_delivery_d: COMMIT
2018-11-26 12:04:31,407 (Thread-1): SQL status: COMMIT in 5.16 seconds
2018-11-26 12:04:31,407 (Thread-1): Using redshift connection "ff_free_delivery_d".
2018-11-26 12:04:31,407 (Thread-1): On ff_free_delivery_d: BEGIN
2018-11-26 12:04:31,425 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 12:04:31,428 (Thread-1): On ff_free_delivery_d: ROLLBACK
2018-11-26 12:04:31,447 (Thread-1): 12:04:31 | 1 of 1 OK created view model dbt_dev.ff_free_delivery_d.............. [CREATE VIEW in 8.30s]
2018-11-26 12:04:31,503 (MainThread): 12:04:31 | 
2018-11-26 12:04:31,503 (MainThread): 12:04:31 | Finished running 1 view models in 8.74s.
2018-11-26 12:04:31,504 (MainThread): Connection 'master' was left open.
2018-11-26 12:04:31,506 (MainThread): 
2018-11-26 12:04:31,507 (MainThread): Completed successfully
2018-11-26 12:04:31,507 (MainThread): 
Done. PASS=1 ERROR=0 SKIP=0 TOTAL=1
2018-11-26 12:04:31,508 (MainThread): Flushing usage events
2018-11-26 12:04:45,998 (MainThread): Tracking: do not track
2018-11-26 12:04:45,998 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 12:04:46,003 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 12:04:46,007 (MainThread): Parsing macros\core.sql
2018-11-26 12:04:46,013 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:04:46,017 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:04:46,027 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:04:46,033 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:04:46,035 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:04:46,036 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:04:46,044 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:04:46,045 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:04:46,046 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:04:46,054 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:04:46,056 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:04:46,063 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:04:46,088 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:04:46,092 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:04:46,098 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:04:46,108 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:04:46,110 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:04:46,124 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:04:46,133 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:04:46,142 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:04:46,150 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:04:46,159 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:04:46,165 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:04:46,166 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:04:46,167 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:04:46,169 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:04:46,170 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:04:46,172 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:04:46,173 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:04:46,175 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:04:46,181 (MainThread): Parsing macros\core.sql
2018-11-26 12:04:46,184 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:04:46,188 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:04:46,197 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:04:46,202 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:04:46,203 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:04:46,205 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:04:46,211 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:04:46,212 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:04:46,213 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:04:46,220 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:04:46,221 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:04:46,227 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:04:46,248 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:04:46,251 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:04:46,257 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:04:46,266 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:04:46,268 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:04:46,281 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:04:46,288 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:04:46,297 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:04:46,305 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:04:46,312 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:04:46,319 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:04:46,320 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:04:46,321 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:04:46,322 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:04:46,323 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:04:46,325 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:04:46,326 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:04:46,328 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:04:46,336 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 12:04:46,351 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 12:04:46,362 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 12:04:46,373 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 12:04:46,385 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 12:04:46,396 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 12:04:46,407 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:46,407 (MainThread): Acquiring new redshift connection "master".
2018-11-26 12:04:46,407 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 12:04:46,408 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:04:54,751 (MainThread): Using redshift connection "master".
2018-11-26 12:04:54,751 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:56,965 (MainThread): SQL status: SELECT in 2.21 seconds
2018-11-26 12:04:56,966 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:04:56,968 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 12:04:56,979 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:56,979 (MainThread): Using redshift connection "master".
2018-11-26 12:04:56,979 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:57,027 (MainThread): SQL status: SELECT in 0.05 seconds
2018-11-26 12:04:57,028 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:04:57,029 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 12:04:57,041 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:57,041 (MainThread): Using redshift connection "master".
2018-11-26 12:04:57,042 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:57,086 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 12:04:57,087 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:04:57,088 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 12:04:57,099 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:57,099 (MainThread): Using redshift connection "master".
2018-11-26 12:04:57,100 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:57,143 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 12:04:57,144 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:04:57,145 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 12:04:57,157 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:57,157 (MainThread): Using redshift connection "master".
2018-11-26 12:04:57,157 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:57,202 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 12:04:57,203 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:04:57,204 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 12:04:57,215 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:04:57,215 (MainThread): Using redshift connection "master".
2018-11-26 12:04:57,216 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:57,258 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 12:04:57,258 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:04:57,259 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 12:04:57,269 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 12:04:57,280 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 12:04:57,291 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 12:04:57,303 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 12:04:57,314 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 12:04:57,366 (MainThread): Found 17 models, 0 tests, 0 analyses, 0 seed files, 94 macros, 2 operations, 0 archives
2018-11-26 12:04:57,367 (MainThread): 
2018-11-26 12:04:57,367 (MainThread): Using redshift connection "master".
2018-11-26 12:04:57,367 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:04:57,411 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 12:04:57,454 (MainThread): Acquiring new redshift connection "get_relations_data".
2018-11-26 12:04:57,454 (MainThread): Opening a new connection (1 currently allocated)
2018-11-26 12:04:57,455 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:05:01,555 (MainThread): Using redshift connection "get_relations_data".
2018-11-26 12:05:01,555 (MainThread): On get_relations_data: BEGIN
2018-11-26 12:05:01,589 (MainThread): SQL status: BEGIN in 0.03 seconds
2018-11-26 12:05:01,590 (MainThread): Using redshift connection "get_relations_data".
2018-11-26 12:05:01,590 (MainThread): On get_relations_data: -- 
    with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg_%'
    ),
    relationships as (
        select
            referenced_class.name as referenced_name,
            referenced_class.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced_class.kind as kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        join dependency on relation.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            referenced_class.kind in ('r', 'v') and
            (referenced_class.name != dependent_class.name or
             referenced_class.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2018-11-26 12:05:02,330 (MainThread): SQL status: SELECT in 0.74 seconds
2018-11-26 12:05:02,339 (MainThread): On get_relations_data: ROLLBACK
2018-11-26 12:05:02,359 (MainThread): Using redshift connection "master".
2018-11-26 12:05:02,359 (MainThread): On master: select distinct nspname from pg_namespace
2018-11-26 12:05:02,379 (MainThread): SQL status: SELECT in 0.02 seconds
2018-11-26 12:05:02,380 (MainThread): 12:05:02 | Concurrency: 1 threads (target='dev')
2018-11-26 12:05:02,380 (MainThread): 12:05:02 | 
2018-11-26 12:05:02,382 (Thread-1): 12:05:02 | 1 of 1 START incremental model dbt_dev.sessions_dlv.................. [RUN]
2018-11-26 12:05:02,383 (Thread-1): Compiling model.elevenia_c2c.sessions_dlv
2018-11-26 12:05:02,389 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_dlv"
2018-11-26 12:05:02,435 (Thread-1): Acquiring new redshift connection "sessions_dlv".
2018-11-26 12:05:02,435 (Thread-1): Re-using an available connection from the pool.
2018-11-26 12:05:02,436 (Thread-1): Using redshift connection "sessions_dlv".
2018-11-26 12:05:02,436 (Thread-1): On sessions_dlv: BEGIN
2018-11-26 12:05:02,471 (Thread-1): SQL status: BEGIN in 0.03 seconds
2018-11-26 12:05:02,471 (Thread-1): Using redshift connection "sessions_dlv".
2018-11-26 12:05:02,471 (Thread-1): On sessions_dlv: 

       create temporary table
    "sessions_dlv__dbt_incremental_tmp"
    diststyle key distkey (basic_dd)
    
      compound sortkey(basic_dd)
  as (
    select * from (
           with all_dlv as (

    select * from "dbt_dev"."ff_free_delivery_d"

),

-- Filter out only the events that have arrived since events have last been processed
new_dlv as (

   select *
   from all_dlv

    -- This conditional is executed just before the model is
    -- executed and returns either True or False
    -- The enclosed `where` filter will be conditionally applied
    -- only if this model exists in the current schema
   
        where basic_dd >= ( select max(basic_dd) from "dbt_dev"."sessions_dlv" )
   

)
select * from new_dlv
         ) as dbt_incr_sbq
         where (basic_dd >= ( select max(basic_dd) from dbt_dev.sessions_dlv ))
           or (basic_dd >= ( select max(basic_dd) from dbt_dev.sessions_dlv )) is null
  );
2018-11-26 12:05:15,687 (Thread-1): SQL status: SELECT in 13.22 seconds
2018-11-26 12:05:15,688 (Thread-1): Using redshift connection "sessions_dlv".
2018-11-26 12:05:15,688 (Thread-1): On sessions_dlv: with bound_views as (
                select
                    ordinal_position,
                    table_schema,
                    column_name,
                    data_type,
                    character_maximum_length,
                    numeric_precision || ',' || numeric_scale as numeric_size

                from information_schema.columns
                where table_name = 'sessions_dlv__dbt_incremental_tmp'
            ),

            unbound_views as (
                select
                    ordinal_position,
                    view_schema,
                    col_name,
                    case
                        when col_type ilike 'character varying%' then
                            'character varying'
                        when col_type ilike 'numeric%' then 'numeric'
                        else col_type
                    end as col_type,
                    case
                        when col_type like 'character%'
                        then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
                        else null
                    end as character_maximum_length,
                    case
                        when col_type like 'numeric%'
                        then nullif(REGEXP_SUBSTR(col_type, '[0-9,]+'), '')
                        else null
                    end as numeric_size

                from pg_get_late_binding_view_cols()
                cols(view_schema name, view_name name, col_name name,
                     col_type varchar, ordinal_position int)
                where view_name = 'sessions_dlv__dbt_incremental_tmp'
            ),

            unioned as (
                select * from bound_views
                union all
                select * from unbound_views
            )

            select
                column_name,
                data_type,
                character_maximum_length,
                numeric_size

            from unioned
            where 1=1
            order by ordinal_position
2018-11-26 12:05:27,782 (Thread-1): SQL status: SELECT in 12.09 seconds
2018-11-26 12:05:27,782 (Thread-1): Using redshift connection "sessions_dlv".
2018-11-26 12:05:27,782 (Thread-1): On sessions_dlv: with bound_views as (
                select
                    ordinal_position,
                    table_schema,
                    column_name,
                    data_type,
                    character_maximum_length,
                    numeric_precision || ',' || numeric_scale as numeric_size

                from information_schema.columns
                where table_name = 'sessions_dlv'
            ),

            unbound_views as (
                select
                    ordinal_position,
                    view_schema,
                    col_name,
                    case
                        when col_type ilike 'character varying%' then
                            'character varying'
                        when col_type ilike 'numeric%' then 'numeric'
                        else col_type
                    end as col_type,
                    case
                        when col_type like 'character%'
                        then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
                        else null
                    end as character_maximum_length,
                    case
                        when col_type like 'numeric%'
                        then nullif(REGEXP_SUBSTR(col_type, '[0-9,]+'), '')
                        else null
                    end as numeric_size

                from pg_get_late_binding_view_cols()
                cols(view_schema name, view_name name, col_name name,
                     col_type varchar, ordinal_position int)
                where view_name = 'sessions_dlv'
            ),

            unioned as (
                select * from bound_views
                union all
                select * from unbound_views
            )

            select
                column_name,
                data_type,
                character_maximum_length,
                numeric_size

            from unioned
            where table_schema = 'dbt_dev'
            order by ordinal_position
2018-11-26 12:05:30,182 (Thread-1): SQL status: SELECT in 2.40 seconds
2018-11-26 12:05:30,182 (Thread-1): Using redshift connection "sessions_dlv".
2018-11-26 12:05:30,182 (Thread-1): On sessions_dlv: with bound_views as (
                select
                    ordinal_position,
                    table_schema,
                    column_name,
                    data_type,
                    character_maximum_length,
                    numeric_precision || ',' || numeric_scale as numeric_size

                from information_schema.columns
                where table_name = 'sessions_dlv'
            ),

            unbound_views as (
                select
                    ordinal_position,
                    view_schema,
                    col_name,
                    case
                        when col_type ilike 'character varying%' then
                            'character varying'
                        when col_type ilike 'numeric%' then 'numeric'
                        else col_type
                    end as col_type,
                    case
                        when col_type like 'character%'
                        then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
                        else null
                    end as character_maximum_length,
                    case
                        when col_type like 'numeric%'
                        then nullif(REGEXP_SUBSTR(col_type, '[0-9,]+'), '')
                        else null
                    end as numeric_size

                from pg_get_late_binding_view_cols()
                cols(view_schema name, view_name name, col_name name,
                     col_type varchar, ordinal_position int)
                where view_name = 'sessions_dlv'
            ),

            unioned as (
                select * from bound_views
                union all
                select * from unbound_views
            )

            select
                column_name,
                data_type,
                character_maximum_length,
                numeric_size

            from unioned
            where table_schema = 'dbt_dev'
            order by ordinal_position
2018-11-26 12:05:31,020 (Thread-1): SQL status: SELECT in 0.84 seconds
2018-11-26 12:05:31,022 (Thread-1): Writing runtime SQL for node "model.elevenia_c2c.sessions_dlv"
2018-11-26 12:05:31,023 (Thread-1): Using redshift connection "sessions_dlv".
2018-11-26 12:05:31,023 (Thread-1): On sessions_dlv: 
       

       delete
  from "dbt_dev"."sessions_dlv"
  where (basic_dd) in (
    select (basic_dd)
    from "sessions_dlv__dbt_incremental_tmp"
  );

       insert into "dbt_dev"."sessions_dlv" ("load_dt", "basic_dd", "paid_gmv", "created_dt")
       (
         select "load_dt", "basic_dd", "paid_gmv", "created_dt"
         from "sessions_dlv__dbt_incremental_tmp"
       );
     
2018-11-26 12:05:31,331 (Thread-1): SQL status: INSERT 0 0 in 0.31 seconds
2018-11-26 12:05:31,332 (Thread-1): On sessions_dlv: COMMIT
2018-11-26 12:05:31,333 (Thread-1): Using redshift connection "sessions_dlv".
2018-11-26 12:05:31,333 (Thread-1): On sessions_dlv: COMMIT
2018-11-26 12:05:31,855 (Thread-1): SQL status: COMMIT in 0.52 seconds
2018-11-26 12:05:31,858 (Thread-1): 12:05:31 | 1 of 1 OK created incremental model dbt_dev.sessions_dlv............. [INSERT 0 0 in 29.47s]
2018-11-26 12:05:31,896 (MainThread): 12:05:31 | 
2018-11-26 12:05:31,897 (MainThread): 12:05:31 | Finished running 1 incremental models in 34.53s.
2018-11-26 12:05:31,897 (MainThread): Connection 'master' was left open.
2018-11-26 12:05:31,901 (MainThread): 
2018-11-26 12:05:31,902 (MainThread): Completed successfully
2018-11-26 12:05:31,902 (MainThread): 
Done. PASS=1 ERROR=0 SKIP=0 TOTAL=1
2018-11-26 12:05:31,902 (MainThread): Flushing usage events
2018-11-26 12:06:25,772 (MainThread): Tracking: do not track
2018-11-26 12:06:25,772 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 12:06:25,779 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 12:06:25,785 (MainThread): Parsing macros\core.sql
2018-11-26 12:06:25,791 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:06:25,795 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:06:25,806 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:06:25,812 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:06:25,814 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:06:25,816 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:06:25,823 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:06:25,825 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:06:25,826 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:06:25,833 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:06:25,836 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:06:25,843 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:06:25,866 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:06:25,871 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:06:25,877 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:06:25,886 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:06:25,889 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:06:25,903 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:06:25,911 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:06:25,920 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:06:25,928 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:06:25,937 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:06:25,944 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:06:25,945 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:06:25,945 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:06:25,947 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:06:25,948 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:06:25,950 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:06:25,951 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:06:25,953 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:06:25,958 (MainThread): Parsing macros\core.sql
2018-11-26 12:06:25,963 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:06:25,966 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:06:25,975 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:06:25,981 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:06:25,982 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:06:25,983 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:06:25,989 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:06:25,991 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:06:25,992 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:06:25,998 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:06:26,000 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:06:26,005 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:06:26,027 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:06:26,031 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:06:26,036 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:06:26,045 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:06:26,046 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:06:26,059 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:06:26,068 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:06:26,077 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:06:26,085 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:06:26,093 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:06:26,100 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:06:26,101 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:06:26,103 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:06:26,105 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:06:26,106 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:06:26,107 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:06:26,108 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:06:26,110 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:06:26,118 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 12:06:26,134 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 12:06:26,144 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 12:06:26,155 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 12:06:26,166 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 12:06:26,177 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 12:06:26,189 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:26,189 (MainThread): Acquiring new redshift connection "master".
2018-11-26 12:06:26,189 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 12:06:26,190 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:06:27,001 (MainThread): Using redshift connection "master".
2018-11-26 12:06:27,001 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:27,104 (MainThread): SQL status: SELECT in 0.10 seconds
2018-11-26 12:06:27,106 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:27,107 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 12:06:27,118 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:27,118 (MainThread): Using redshift connection "master".
2018-11-26 12:06:27,118 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:27,213 (MainThread): SQL status: SELECT in 0.09 seconds
2018-11-26 12:06:27,214 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:27,215 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 12:06:27,227 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:27,227 (MainThread): Using redshift connection "master".
2018-11-26 12:06:27,227 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:27,324 (MainThread): SQL status: SELECT in 0.10 seconds
2018-11-26 12:06:27,325 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:27,326 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 12:06:27,339 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:27,339 (MainThread): Using redshift connection "master".
2018-11-26 12:06:27,339 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:27,401 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 12:06:27,402 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:27,403 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 12:06:27,415 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:27,415 (MainThread): Using redshift connection "master".
2018-11-26 12:06:27,415 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:27,501 (MainThread): SQL status: SELECT in 0.09 seconds
2018-11-26 12:06:27,503 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:27,504 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 12:06:27,515 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:27,515 (MainThread): Using redshift connection "master".
2018-11-26 12:06:27,515 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:27,590 (MainThread): SQL status: SELECT in 0.07 seconds
2018-11-26 12:06:27,591 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:27,592 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 12:06:27,603 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 12:06:27,613 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 12:06:27,625 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 12:06:27,635 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 12:06:27,646 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 12:06:27,690 (MainThread): Found 0 analyses, 17 models, 0 archives, 94 macros, 0 seed files, 2 operations, 0 tests
2018-11-26 12:06:27,698 (MainThread): 
2018-11-26 12:06:27,698 (MainThread): 12:06:27 | Concurrency: 1 threads (target='dev')
2018-11-26 12:06:27,699 (MainThread): 12:06:27 | 
2018-11-26 12:06:27,701 (Thread-1): Compiling model.elevenia_c2c.ff_free_delivery_d
2018-11-26 12:06:27,705 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ff_free_delivery_d"
2018-11-26 12:06:27,707 (Thread-1): Compiling model.elevenia_c2c.ord_trx_hourly
2018-11-26 12:06:27,710 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_trx_hourly"
2018-11-26 12:06:27,713 (Thread-1): Compiling model.elevenia_c2c.ord_no_hr_paid
2018-11-26 12:06:27,717 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_no_hr_paid"
2018-11-26 12:06:27,720 (Thread-1): Compiling model.elevenia_c2c.paid_trx_hourly
2018-11-26 12:06:27,724 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.paid_trx_hourly"
2018-11-26 12:06:27,727 (Thread-1): Compiling model.elevenia_c2c.ord_no_hr
2018-11-26 12:06:27,730 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_no_hr"
2018-11-26 12:06:27,733 (Thread-1): Compiling model.elevenia_c2c.xbi_1087_top_100
2018-11-26 12:06:27,736 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.xbi_1087_top_100"
2018-11-26 12:06:27,740 (Thread-1): Compiling model.elevenia_c2c.rangga_test
2018-11-26 12:06:27,743 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.rangga_test"
2018-11-26 12:06:27,746 (Thread-1): Compiling model.elevenia_c2c.dd_address
2018-11-26 12:06:27,749 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_address"
2018-11-26 12:06:27,752 (Thread-1): Compiling model.elevenia_c2c.dd_disp_ctgr
2018-11-26 12:06:27,754 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_disp_ctgr"
2018-11-26 12:06:27,759 (Thread-1): Compiling model.elevenia_c2c.sessions_paid_test
2018-11-26 12:06:27,763 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:27,763 (Thread-1): Using redshift connection "master".
2018-11-26 12:06:27,763 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:27,860 (Thread-1): SQL status: SELECT in 0.10 seconds
2018-11-26 12:06:27,861 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:27,862 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_paid_test"
2018-11-26 12:06:27,864 (Thread-1): Compiling model.elevenia_c2c.dd_address_v2
2018-11-26 12:06:27,868 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_address_v2"
2018-11-26 12:06:27,871 (Thread-1): Compiling model.elevenia_c2c.sessions_ord_test
2018-11-26 12:06:27,875 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:27,876 (Thread-1): Using redshift connection "master".
2018-11-26 12:06:27,876 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:27,949 (Thread-1): SQL status: SELECT in 0.07 seconds
2018-11-26 12:06:27,951 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:27,952 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_ord_test"
2018-11-26 12:06:27,955 (Thread-1): Compiling model.elevenia_c2c.sessions_dlv
2018-11-26 12:06:27,959 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:27,960 (Thread-1): Using redshift connection "master".
2018-11-26 12:06:27,960 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:28,030 (Thread-1): SQL status: SELECT in 0.07 seconds
2018-11-26 12:06:28,031 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:28,032 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_dlv"
2018-11-26 12:06:28,034 (Thread-1): Compiling model.elevenia_c2c.sessions
2018-11-26 12:06:28,039 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:28,039 (Thread-1): Using redshift connection "master".
2018-11-26 12:06:28,040 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:28,141 (Thread-1): SQL status: SELECT in 0.10 seconds
2018-11-26 12:06:28,142 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:28,143 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions"
2018-11-26 12:06:28,145 (Thread-1): Compiling model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 12:06:28,150 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:28,150 (Thread-1): Using redshift connection "master".
2018-11-26 12:06:28,150 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:28,275 (Thread-1): SQL status: SELECT in 0.12 seconds
2018-11-26 12:06:28,276 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:28,277 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_ord_no_hr"
2018-11-26 12:06:28,280 (Thread-1): Compiling model.elevenia_c2c.dd_address_v3
2018-11-26 12:06:28,283 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_address_v3"
2018-11-26 12:06:28,286 (Thread-1): Compiling model.elevenia_c2c.sessions_paid
2018-11-26 12:06:28,294 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:28,294 (Thread-1): Using redshift connection "master".
2018-11-26 12:06:28,294 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:28,384 (Thread-1): SQL status: SELECT in 0.09 seconds
2018-11-26 12:06:28,385 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:28,386 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_paid"
2018-11-26 12:06:28,405 (MainThread): Connection 'master' was left open.
2018-11-26 12:06:28,422 (MainThread): 12:06:28 | Done.
2018-11-26 12:06:28,424 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 12:06:28,429 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 12:06:28,433 (MainThread): Parsing macros\core.sql
2018-11-26 12:06:28,438 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:06:28,442 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:06:28,454 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:06:28,461 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:06:28,463 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:06:28,465 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:06:28,472 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:06:28,474 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:06:28,475 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:06:28,482 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:06:28,484 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:06:28,491 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:06:28,516 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:06:28,521 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:06:28,527 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:06:28,535 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:06:28,538 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:06:28,552 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:06:28,560 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:06:28,569 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:06:28,577 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:06:28,585 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:06:28,592 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:06:28,593 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:06:28,595 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:06:28,596 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:06:28,597 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:06:28,599 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:06:28,600 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:06:28,601 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:06:28,608 (MainThread): Parsing macros\core.sql
2018-11-26 12:06:28,611 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:06:28,615 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:06:28,623 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:06:28,629 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:06:28,630 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:06:28,631 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:06:28,637 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:06:28,638 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:06:28,640 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:06:28,647 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:06:28,649 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:06:28,654 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:06:28,674 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:06:28,677 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:06:28,682 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:06:28,691 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:06:28,693 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:06:28,705 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:06:28,713 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:06:28,722 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:06:28,730 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:06:28,737 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:06:28,744 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:06:28,746 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:06:28,747 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:06:28,748 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:06:28,749 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:06:28,750 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:06:28,751 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:06:28,752 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:06:28,760 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 12:06:28,771 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 12:06:28,781 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 12:06:28,793 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 12:06:28,804 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 12:06:28,816 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 12:06:28,828 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:28,828 (MainThread): Acquiring new redshift connection "master".
2018-11-26 12:06:28,828 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 12:06:28,829 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:06:28,964 (MainThread): Using redshift connection "master".
2018-11-26 12:06:28,964 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:29,094 (MainThread): SQL status: SELECT in 0.13 seconds
2018-11-26 12:06:29,096 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:29,097 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 12:06:29,109 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:29,109 (MainThread): Using redshift connection "master".
2018-11-26 12:06:29,109 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:29,172 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 12:06:29,173 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:29,174 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 12:06:29,186 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:29,187 (MainThread): Using redshift connection "master".
2018-11-26 12:06:29,187 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:29,277 (MainThread): SQL status: SELECT in 0.09 seconds
2018-11-26 12:06:29,278 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:29,279 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 12:06:29,290 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:29,290 (MainThread): Using redshift connection "master".
2018-11-26 12:06:29,291 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:29,376 (MainThread): SQL status: SELECT in 0.08 seconds
2018-11-26 12:06:29,377 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:29,378 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 12:06:29,389 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:29,390 (MainThread): Using redshift connection "master".
2018-11-26 12:06:29,390 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:29,451 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 12:06:29,453 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:29,455 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 12:06:29,467 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:06:29,467 (MainThread): Using redshift connection "master".
2018-11-26 12:06:29,467 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:06:29,535 (MainThread): SQL status: SELECT in 0.07 seconds
2018-11-26 12:06:29,537 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:06:29,539 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 12:06:29,554 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 12:06:29,564 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 12:06:29,575 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 12:06:29,586 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 12:06:29,596 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 12:06:29,629 (MainThread): 12:06:29 | Building catalog
2018-11-26 12:06:29,669 (MainThread): Acquiring new redshift connection "get_catalog_data".
2018-11-26 12:06:29,669 (MainThread): Opening a new connection (1 currently allocated)
2018-11-26 12:06:29,670 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:06:29,808 (MainThread): Using redshift connection "get_catalog_data".
2018-11-26 12:06:29,808 (MainThread): On get_catalog_data: BEGIN
2018-11-26 12:06:29,846 (MainThread): SQL status: BEGIN in 0.04 seconds
2018-11-26 12:06:29,846 (MainThread): Using redshift connection "get_catalog_data".
2018-11-26 12:06:29,846 (MainThread): On get_catalog_data: with late_binding as (
      select
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    tables as (

      select
          table_schema,
          table_name,
          table_type

      from information_schema.tables

    ),

    table_owners as (

        select
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    columns as (

        select
            table_schema,
            table_name,
            null::varchar as table_comment,

            column_name,
            ordinal_position as column_index,
            data_type as column_type,
            null::varchar as column_comment


        from information_schema.columns

    ),

    unioned as (

        select *
        from tables
        join columns using (table_schema, table_name)

        union all

        select *
        from late_binding

    )

    select *,
        table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_schema, table_name)

    where table_schema != 'information_schema'
      and table_schema not like 'pg_%'

    order by "column_index"
2018-11-26 12:06:31,593 (MainThread): SQL status: SELECT in 1.75 seconds
2018-11-26 12:06:33,105 (MainThread): Using redshift connection "get_catalog_data".
2018-11-26 12:06:33,105 (MainThread): On get_catalog_data: select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
2018-11-26 12:06:33,124 (MainThread): SQL status: SELECT in 0.02 seconds
2018-11-26 12:06:33,125 (MainThread): 

    Warning: The database user "dbt_user" has insufficient permissions to
    query the "svv_table_info" table. Please grant SELECT permissions on this table
    to the "dbt_user" user to fetch extended table details from Redshift.

    
2018-11-26 12:06:33,332 (MainThread): On get_catalog_data: ROLLBACK
2018-11-26 12:06:33,497 (MainThread): 12:06:33 | Catalog written to D:\project\elevenia_c2c\target\catalog.json
2018-11-26 12:06:33,498 (MainThread): Flushing usage events
2018-11-26 12:08:28,596 (MainThread): Tracking: do not track
2018-11-26 12:08:28,599 (MainThread): Serving docs at 0.0.0.0:8080
2018-11-26 12:08:28,600 (MainThread): To access from your browser, navigate to http://localhost:8080.
2018-11-26 12:08:28,600 (MainThread): Press Ctrl+C to exit.


2018-11-26 12:13:10,364 (MainThread): Flushing usage events
2018-11-26 12:13:10,364 (MainThread): ctrl-c
2018-11-26 12:19:38,886 (MainThread): Tracking: do not track
2018-11-26 12:19:38,886 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 12:19:38,891 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 12:19:38,896 (MainThread): Parsing macros\core.sql
2018-11-26 12:19:38,902 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:19:38,906 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:19:38,918 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:19:38,926 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:19:38,928 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:19:38,929 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:19:38,937 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:19:38,939 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:19:38,940 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:19:38,948 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:19:38,951 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:19:38,958 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:19:38,986 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:19:38,990 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:19:38,995 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:19:39,005 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:19:39,007 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:19:39,021 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:19:39,029 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:19:39,038 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:19:39,045 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:19:39,054 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:19:39,060 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:19:39,061 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:19:39,062 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:19:39,064 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:19:39,065 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:19:39,067 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:19:39,068 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:19:39,070 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:19:39,075 (MainThread): Parsing macros\core.sql
2018-11-26 12:19:39,078 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:19:39,081 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:19:39,090 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:19:39,096 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:19:39,097 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:19:39,098 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:19:39,104 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:19:39,106 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:19:39,106 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:19:39,113 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:19:39,115 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:19:39,120 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:19:39,141 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:19:39,144 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:19:39,150 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:19:39,159 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:19:39,161 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:19:39,173 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:19:39,181 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:19:39,190 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:19:39,198 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:19:39,205 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:19:39,212 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:19:39,213 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:19:39,214 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:19:39,215 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:19:39,216 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:19:39,218 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:19:39,219 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:19:39,221 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:19:39,228 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 12:19:39,244 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 12:19:39,255 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 12:19:39,267 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 12:19:39,278 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 12:19:39,289 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 12:19:39,302 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:39,302 (MainThread): Acquiring new redshift connection "master".
2018-11-26 12:19:39,302 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 12:19:39,302 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:19:40,079 (MainThread): Using redshift connection "master".
2018-11-26 12:19:40,079 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:40,217 (MainThread): SQL status: SELECT in 0.14 seconds
2018-11-26 12:19:40,218 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:19:40,220 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 12:19:40,230 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:40,230 (MainThread): Using redshift connection "master".
2018-11-26 12:19:40,230 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:40,285 (MainThread): SQL status: SELECT in 0.05 seconds
2018-11-26 12:19:40,286 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:19:40,288 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 12:19:40,299 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:40,300 (MainThread): Using redshift connection "master".
2018-11-26 12:19:40,300 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:40,345 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 12:19:40,346 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:19:40,347 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 12:19:40,359 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:40,359 (MainThread): Using redshift connection "master".
2018-11-26 12:19:40,359 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:40,404 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 12:19:40,405 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:19:40,406 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 12:19:40,418 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:40,418 (MainThread): Using redshift connection "master".
2018-11-26 12:19:40,418 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:40,464 (MainThread): SQL status: SELECT in 0.05 seconds
2018-11-26 12:19:40,465 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:19:40,466 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 12:19:40,478 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:40,478 (MainThread): Using redshift connection "master".
2018-11-26 12:19:40,478 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:40,523 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 12:19:40,525 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">]
2018-11-26 12:19:40,526 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 12:19:40,537 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 12:19:40,547 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 12:19:40,557 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 12:19:40,569 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 12:19:40,579 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 12:19:40,622 (MainThread): Found 0 archives, 0 analyses, 0 tests, 2 operations, 94 macros, 0 seed files, 17 models
2018-11-26 12:19:40,623 (MainThread): 
2018-11-26 12:19:40,623 (MainThread): Using redshift connection "master".
2018-11-26 12:19:40,623 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:40,668 (MainThread): SQL status: SELECT in 0.04 seconds
2018-11-26 12:19:40,702 (MainThread): Acquiring new redshift connection "get_relations_data".
2018-11-26 12:19:40,702 (MainThread): Opening a new connection (1 currently allocated)
2018-11-26 12:19:40,703 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:19:40,835 (MainThread): Using redshift connection "get_relations_data".
2018-11-26 12:19:40,835 (MainThread): On get_relations_data: BEGIN
2018-11-26 12:19:40,870 (MainThread): SQL status: BEGIN in 0.03 seconds
2018-11-26 12:19:40,870 (MainThread): Using redshift connection "get_relations_data".
2018-11-26 12:19:40,870 (MainThread): On get_relations_data: -- 
    with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg_%'
    ),
    relationships as (
        select
            referenced_class.name as referenced_name,
            referenced_class.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced_class.kind as kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        join dependency on relation.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            referenced_class.kind in ('r', 'v') and
            (referenced_class.name != dependent_class.name or
             referenced_class.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2018-11-26 12:19:40,958 (MainThread): SQL status: SELECT in 0.09 seconds
2018-11-26 12:19:40,968 (MainThread): On get_relations_data: ROLLBACK
2018-11-26 12:19:40,988 (MainThread): Using redshift connection "master".
2018-11-26 12:19:40,988 (MainThread): On master: select distinct nspname from pg_namespace
2018-11-26 12:19:41,005 (MainThread): SQL status: SELECT in 0.02 seconds
2018-11-26 12:19:41,006 (MainThread): 12:19:41 | Concurrency: 1 threads (target='dev')
2018-11-26 12:19:41,006 (MainThread): 12:19:41 | 
2018-11-26 12:19:41,008 (Thread-1): 12:19:41 | 1 of 1 START view model dbt_dev.ord_no_hr............................ [RUN]
2018-11-26 12:19:41,009 (Thread-1): Compiling model.elevenia_c2c.ord_no_hr
2018-11-26 12:19:41,012 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_no_hr"
2018-11-26 12:19:41,041 (Thread-1): Acquiring new redshift connection "ord_no_hr".
2018-11-26 12:19:41,041 (Thread-1): Re-using an available connection from the pool.
2018-11-26 12:19:41,041 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:41,041 (Thread-1): On ord_no_hr: BEGIN
2018-11-26 12:19:41,076 (Thread-1): SQL status: BEGIN in 0.03 seconds
2018-11-26 12:19:41,077 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:41,077 (Thread-1): On ord_no_hr: drop view if exists "dbt_dev"."ord_no_hr__dbt_tmp" cascade
2018-11-26 12:19:41,094 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2018-11-26 12:19:41,094 (Thread-1): On ord_no_hr: COMMIT
2018-11-26 12:19:41,094 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:41,095 (Thread-1): On ord_no_hr: COMMIT
2018-11-26 12:19:42,517 (Thread-1): SQL status: COMMIT in 1.42 seconds
2018-11-26 12:19:42,518 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:42,518 (Thread-1): On ord_no_hr: BEGIN
2018-11-26 12:19:42,536 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 12:19:42,536 (Thread-1): On ord_no_hr: COMMIT
2018-11-26 12:19:42,536 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:42,536 (Thread-1): On ord_no_hr: COMMIT
2018-11-26 12:19:42,554 (Thread-1): SQL status: COMMIT in 0.02 seconds
2018-11-26 12:19:42,554 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:42,554 (Thread-1): On ord_no_hr: BEGIN
2018-11-26 12:19:42,573 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 12:19:42,574 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:42,574 (Thread-1): On ord_no_hr: drop view if exists "dbt_dev"."ord_no_hr__dbt_backup" cascade
2018-11-26 12:19:42,592 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2018-11-26 12:19:42,592 (Thread-1): On ord_no_hr: COMMIT
2018-11-26 12:19:42,592 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:42,592 (Thread-1): On ord_no_hr: COMMIT
2018-11-26 12:19:44,027 (Thread-1): SQL status: COMMIT in 1.44 seconds
2018-11-26 12:19:44,028 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:44,028 (Thread-1): On ord_no_hr: BEGIN
2018-11-26 12:19:44,047 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 12:19:44,060 (Thread-1): Writing runtime SQL for node "model.elevenia_c2c.ord_no_hr"
2018-11-26 12:19:44,061 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:44,061 (Thread-1): On ord_no_hr: 

  create view "dbt_dev"."ord_no_hr__dbt_tmp" as (
    SELECT to_char(ord_dt,'YYYYMMDD-HH24') ord_dy_conc_hr
--, to_char(ord_stl_end_dt,'YYYYMMDD-HH24') ord_stl_end_dy_conc_hr
--, to_char(pocnfrm_dt,'YYYYMMDD-HH24') pocnfrm_dy_conc_hr
, dateadd(hour,7,getdate()) created_dt
--, t2.en_ord_prd_stat_nm
, max(ord_no) ord_no_max
from dwuser.sd_sales_dtls t1
--inner join dwuser.dd_ord_prd_stat t2 on t1.ord_prd_stat = t2.ord_prd_stat_cd
--where to_char(ord_dt,'YYYYMMDD') >= to_char(dateadd(day,-3,getdate()),'YYYYMMDD')
where ord_dt::DATE >= trunc(getdate()) 
group by 1
order by 1 desc--,2 desc, 5 asc
  ) ;
2018-11-26 12:19:44,107 (Thread-1): SQL status: CREATE VIEW in 0.05 seconds
2018-11-26 12:19:44,109 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:44,109 (Thread-1): On ord_no_hr: alter table "dbt_dev"."ord_no_hr" rename to "ord_no_hr__dbt_backup"
2018-11-26 12:19:44,946 (Thread-1): SQL status: ALTER TABLE in 0.84 seconds
2018-11-26 12:19:44,947 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:44,947 (Thread-1): On ord_no_hr: alter table "dbt_dev"."ord_no_hr__dbt_tmp" rename to "ord_no_hr"
2018-11-26 12:19:44,966 (Thread-1): SQL status: ALTER TABLE in 0.02 seconds
2018-11-26 12:19:44,966 (Thread-1): On ord_no_hr: COMMIT
2018-11-26 12:19:44,966 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:44,967 (Thread-1): On ord_no_hr: COMMIT
2018-11-26 12:19:45,782 (Thread-1): SQL status: COMMIT in 0.81 seconds
2018-11-26 12:19:45,782 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:45,782 (Thread-1): On ord_no_hr: BEGIN
2018-11-26 12:19:45,800 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 12:19:45,801 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:45,801 (Thread-1): On ord_no_hr: drop view if exists "dbt_dev"."ord_no_hr__dbt_backup" cascade
2018-11-26 12:19:46,586 (Thread-1): SQL status: DROP VIEW in 0.78 seconds
2018-11-26 12:19:46,586 (Thread-1): On ord_no_hr: COMMIT
2018-11-26 12:19:46,586 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:46,586 (Thread-1): On ord_no_hr: COMMIT
2018-11-26 12:19:47,359 (Thread-1): SQL status: COMMIT in 0.77 seconds
2018-11-26 12:19:47,360 (Thread-1): Using redshift connection "ord_no_hr".
2018-11-26 12:19:47,360 (Thread-1): On ord_no_hr: BEGIN
2018-11-26 12:19:47,378 (Thread-1): SQL status: BEGIN in 0.02 seconds
2018-11-26 12:19:47,379 (Thread-1): On ord_no_hr: ROLLBACK
2018-11-26 12:19:47,398 (Thread-1): 12:19:47 | 1 of 1 OK created view model dbt_dev.ord_no_hr....................... [CREATE VIEW in 6.39s]
2018-11-26 12:19:47,454 (MainThread): 12:19:47 | 
2018-11-26 12:19:47,455 (MainThread): 12:19:47 | Finished running 1 view models in 6.83s.
2018-11-26 12:19:47,455 (MainThread): Connection 'master' was left open.
2018-11-26 12:19:47,457 (MainThread): 
2018-11-26 12:19:47,458 (MainThread): Completed successfully
2018-11-26 12:19:47,458 (MainThread): 
Done. PASS=1 ERROR=0 SKIP=0 TOTAL=1
2018-11-26 12:19:47,459 (MainThread): Flushing usage events
2018-11-26 12:19:56,306 (MainThread): Tracking: do not track
2018-11-26 12:19:56,306 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 12:19:56,311 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 12:19:56,317 (MainThread): Parsing macros\core.sql
2018-11-26 12:19:56,322 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:19:56,328 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:19:56,342 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:19:56,351 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:19:56,353 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:19:56,355 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:19:56,361 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:19:56,364 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:19:56,365 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:19:56,373 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:19:56,376 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:19:56,383 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:19:56,407 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:19:56,411 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:19:56,417 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:19:56,426 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:19:56,429 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:19:56,444 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:19:56,454 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:19:56,463 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:19:56,472 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:19:56,481 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:19:56,488 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:19:56,489 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:19:56,490 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:19:56,492 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:19:56,493 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:19:56,495 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:19:56,496 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:19:56,498 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:19:56,505 (MainThread): Parsing macros\core.sql
2018-11-26 12:19:56,508 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:19:56,512 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:19:56,521 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:19:56,527 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:19:56,528 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:19:56,530 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:19:56,536 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:19:56,538 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:19:56,538 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:19:56,545 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:19:56,548 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:19:56,553 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:19:56,574 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:19:56,578 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:19:56,584 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:19:56,593 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:19:56,595 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:19:56,609 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:19:56,619 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:19:56,628 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:19:56,636 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:19:56,644 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:19:56,651 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:19:56,653 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:19:56,654 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:19:56,656 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:19:56,656 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:19:56,658 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:19:56,659 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:19:56,660 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:19:56,670 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 12:19:56,687 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 12:19:56,700 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 12:19:56,712 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 12:19:56,725 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 12:19:56,742 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 12:19:56,757 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:56,757 (MainThread): Acquiring new redshift connection "master".
2018-11-26 12:19:56,757 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 12:19:56,758 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:19:57,632 (MainThread): Using redshift connection "master".
2018-11-26 12:19:57,632 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:57,756 (MainThread): SQL status: SELECT in 0.12 seconds
2018-11-26 12:19:57,757 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:57,758 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 12:19:57,770 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:57,770 (MainThread): Using redshift connection "master".
2018-11-26 12:19:57,770 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:57,856 (MainThread): SQL status: SELECT in 0.09 seconds
2018-11-26 12:19:57,857 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:57,858 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 12:19:57,871 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:57,871 (MainThread): Using redshift connection "master".
2018-11-26 12:19:57,871 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:57,940 (MainThread): SQL status: SELECT in 0.07 seconds
2018-11-26 12:19:57,941 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:57,943 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 12:19:57,954 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:57,954 (MainThread): Using redshift connection "master".
2018-11-26 12:19:57,954 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:58,046 (MainThread): SQL status: SELECT in 0.09 seconds
2018-11-26 12:19:58,048 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:58,049 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 12:19:58,060 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:58,060 (MainThread): Using redshift connection "master".
2018-11-26 12:19:58,060 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:58,148 (MainThread): SQL status: SELECT in 0.09 seconds
2018-11-26 12:19:58,149 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:58,150 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 12:19:58,161 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:58,161 (MainThread): Using redshift connection "master".
2018-11-26 12:19:58,161 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:58,227 (MainThread): SQL status: SELECT in 0.07 seconds
2018-11-26 12:19:58,228 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:58,230 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 12:19:58,240 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 12:19:58,252 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 12:19:58,263 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 12:19:58,274 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 12:19:58,286 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 12:19:58,329 (MainThread): Found 94 macros, 0 archives, 2 operations, 17 models, 0 analyses, 0 seed files, 0 tests
2018-11-26 12:19:58,341 (MainThread): 
2018-11-26 12:19:58,342 (MainThread): 12:19:58 | Concurrency: 1 threads (target='dev')
2018-11-26 12:19:58,343 (MainThread): 12:19:58 | 
2018-11-26 12:19:58,346 (Thread-1): Compiling model.elevenia_c2c.dd_address
2018-11-26 12:19:58,349 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_address"
2018-11-26 12:19:58,351 (Thread-1): Compiling model.elevenia_c2c.ord_no_hr
2018-11-26 12:19:58,355 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_no_hr"
2018-11-26 12:19:58,357 (Thread-1): Compiling model.elevenia_c2c.xbi_1087_top_100
2018-11-26 12:19:58,361 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.xbi_1087_top_100"
2018-11-26 12:19:58,364 (Thread-1): Compiling model.elevenia_c2c.ord_trx_hourly
2018-11-26 12:19:58,367 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_trx_hourly"
2018-11-26 12:19:58,371 (Thread-1): Compiling model.elevenia_c2c.ff_free_delivery_d
2018-11-26 12:19:58,374 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ff_free_delivery_d"
2018-11-26 12:19:58,377 (Thread-1): Compiling model.elevenia_c2c.dd_disp_ctgr
2018-11-26 12:19:58,379 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_disp_ctgr"
2018-11-26 12:19:58,383 (Thread-1): Compiling model.elevenia_c2c.rangga_test
2018-11-26 12:19:58,386 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.rangga_test"
2018-11-26 12:19:58,389 (Thread-1): Compiling model.elevenia_c2c.paid_trx_hourly
2018-11-26 12:19:58,392 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.paid_trx_hourly"
2018-11-26 12:19:58,396 (Thread-1): Compiling model.elevenia_c2c.ord_no_hr_paid
2018-11-26 12:19:58,400 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.ord_no_hr_paid"
2018-11-26 12:19:58,404 (Thread-1): Compiling model.elevenia_c2c.dd_address_v3
2018-11-26 12:19:58,407 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_address_v3"
2018-11-26 12:19:58,410 (Thread-1): Compiling model.elevenia_c2c.sessions_paid
2018-11-26 12:19:58,415 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:58,415 (Thread-1): Using redshift connection "master".
2018-11-26 12:19:58,415 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:58,482 (Thread-1): SQL status: SELECT in 0.07 seconds
2018-11-26 12:19:58,484 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:58,485 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_paid"
2018-11-26 12:19:58,487 (Thread-1): Compiling model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 12:19:58,492 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:58,493 (Thread-1): Using redshift connection "master".
2018-11-26 12:19:58,493 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:58,582 (Thread-1): SQL status: SELECT in 0.09 seconds
2018-11-26 12:19:58,584 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:58,586 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_ord_no_hr"
2018-11-26 12:19:58,589 (Thread-1): Compiling model.elevenia_c2c.sessions_paid_test
2018-11-26 12:19:58,594 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:58,594 (Thread-1): Using redshift connection "master".
2018-11-26 12:19:58,594 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:58,685 (Thread-1): SQL status: SELECT in 0.09 seconds
2018-11-26 12:19:58,686 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:58,687 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_paid_test"
2018-11-26 12:19:58,690 (Thread-1): Compiling model.elevenia_c2c.sessions_ord_test
2018-11-26 12:19:58,694 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:58,694 (Thread-1): Using redshift connection "master".
2018-11-26 12:19:58,694 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:58,761 (Thread-1): SQL status: SELECT in 0.07 seconds
2018-11-26 12:19:58,763 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:58,765 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_ord_test"
2018-11-26 12:19:58,767 (Thread-1): Compiling model.elevenia_c2c.dd_address_v2
2018-11-26 12:19:58,771 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.dd_address_v2"
2018-11-26 12:19:58,774 (Thread-1): Compiling model.elevenia_c2c.sessions
2018-11-26 12:19:58,779 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:58,780 (Thread-1): Using redshift connection "master".
2018-11-26 12:19:58,780 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:58,904 (Thread-1): SQL status: SELECT in 0.12 seconds
2018-11-26 12:19:58,906 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:58,907 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions"
2018-11-26 12:19:58,909 (Thread-1): Compiling model.elevenia_c2c.sessions_dlv
2018-11-26 12:19:58,914 (Thread-1): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:58,915 (Thread-1): Using redshift connection "master".
2018-11-26 12:19:58,915 (Thread-1): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:59,003 (Thread-1): SQL status: SELECT in 0.09 seconds
2018-11-26 12:19:59,004 (Thread-1): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:59,005 (Thread-1): Writing injected SQL for node "model.elevenia_c2c.sessions_dlv"
2018-11-26 12:19:59,050 (MainThread): Connection 'master' was left open.
2018-11-26 12:19:59,067 (MainThread): 12:19:59 | Done.
2018-11-26 12:19:59,069 (MainThread): Loading dependency project from c:\users\alvinlaz\appdata\local\programs\python\python35\lib\site-packages\dbt\include
2018-11-26 12:19:59,074 (MainThread): Loading dependency project from D:\project\elevenia_c2c\dbt_modules
2018-11-26 12:19:59,078 (MainThread): Parsing macros\core.sql
2018-11-26 12:19:59,083 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:19:59,088 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:19:59,101 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:19:59,107 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:19:59,109 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:19:59,111 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:19:59,118 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:19:59,120 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:19:59,121 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:19:59,128 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:19:59,131 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:19:59,138 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:19:59,162 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:19:59,167 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:19:59,172 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:19:59,182 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:19:59,185 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:19:59,205 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:19:59,214 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:19:59,223 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:19:59,232 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:19:59,240 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:19:59,247 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:19:59,248 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:19:59,249 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:19:59,250 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:19:59,251 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:19:59,252 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:19:59,254 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:19:59,255 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:19:59,261 (MainThread): Parsing macros\core.sql
2018-11-26 12:19:59,265 (MainThread): Parsing macros\adapters\bigquery.sql
2018-11-26 12:19:59,268 (MainThread): Parsing macros\adapters\common.sql
2018-11-26 12:19:59,277 (MainThread): Parsing macros\adapters\redshift.sql
2018-11-26 12:19:59,283 (MainThread): Parsing macros\adapters\snowflake.sql
2018-11-26 12:19:59,284 (MainThread): Parsing macros\catalog\postgres_catalog.sql
2018-11-26 12:19:59,286 (MainThread): Parsing macros\catalog\redshift_catalog.sql
2018-11-26 12:19:59,294 (MainThread): Parsing macros\catalog\snowflake_catalog.sql
2018-11-26 12:19:59,296 (MainThread): Parsing macros\etc\bigquery.sql
2018-11-26 12:19:59,298 (MainThread): Parsing macros\etc\datetime.sql
2018-11-26 12:19:59,306 (MainThread): Parsing macros\etc\get_custom_schema.sql
2018-11-26 12:19:59,308 (MainThread): Parsing macros\materializations\helpers.sql
2018-11-26 12:19:59,313 (MainThread): Parsing macros\materializations\archive\archive.sql
2018-11-26 12:19:59,333 (MainThread): Parsing macros\materializations\common\merge.sql
2018-11-26 12:19:59,336 (MainThread): Parsing macros\materializations\incremental\bigquery_incremental.sql
2018-11-26 12:19:59,344 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2018-11-26 12:19:59,354 (MainThread): Parsing macros\materializations\seed\bigquery.sql
2018-11-26 12:19:59,356 (MainThread): Parsing macros\materializations\seed\seed.sql
2018-11-26 12:19:59,370 (MainThread): Parsing macros\materializations\table\bigquery_table.sql
2018-11-26 12:19:59,378 (MainThread): Parsing macros\materializations\table\snowflake_table.sql
2018-11-26 12:19:59,387 (MainThread): Parsing macros\materializations\table\table.sql
2018-11-26 12:19:59,397 (MainThread): Parsing macros\materializations\view\bq_snowflake_view.sql
2018-11-26 12:19:59,404 (MainThread): Parsing macros\materializations\view\view.sql
2018-11-26 12:19:59,411 (MainThread): Parsing macros\operations\catalog\get_catalog.sql
2018-11-26 12:19:59,412 (MainThread): Parsing macros\operations\relations\get_relations.sql
2018-11-26 12:19:59,414 (MainThread): Parsing macros\relations\postgres_relations.sql
2018-11-26 12:19:59,415 (MainThread): Parsing macros\relations\redshift_relations.sql
2018-11-26 12:19:59,416 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2018-11-26 12:19:59,418 (MainThread): Parsing macros\schema_tests\not_null.sql
2018-11-26 12:19:59,419 (MainThread): Parsing macros\schema_tests\relationships.sql
2018-11-26 12:19:59,420 (MainThread): Parsing macros\schema_tests\unique.sql
2018-11-26 12:19:59,428 (MainThread): Parsing model.elevenia_c2c.xbi_1087_top_100
2018-11-26 12:19:59,440 (MainThread): Parsing model.elevenia_c2c.ord_no_hr
2018-11-26 12:19:59,451 (MainThread): Parsing model.elevenia_c2c.ord_no_hr_paid
2018-11-26 12:19:59,462 (MainThread): Parsing model.elevenia_c2c.ord_trx_hourly
2018-11-26 12:19:59,474 (MainThread): Parsing model.elevenia_c2c.paid_trx_hourly
2018-11-26 12:19:59,486 (MainThread): Parsing model.elevenia_c2c.sessions
2018-11-26 12:19:59,498 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:59,498 (MainThread): Acquiring new redshift connection "master".
2018-11-26 12:19:59,498 (MainThread): Opening a new connection (0 currently allocated)
2018-11-26 12:19:59,499 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:19:59,656 (MainThread): Using redshift connection "master".
2018-11-26 12:19:59,656 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:59,785 (MainThread): SQL status: SELECT in 0.13 seconds
2018-11-26 12:19:59,787 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:59,788 (MainThread): Parsing model.elevenia_c2c.sessions_dlv
2018-11-26 12:19:59,801 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:59,801 (MainThread): Using redshift connection "master".
2018-11-26 12:19:59,801 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:59,861 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 12:19:59,862 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:59,865 (MainThread): Parsing model.elevenia_c2c.sessions_ord_no_hr
2018-11-26 12:19:59,876 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:59,877 (MainThread): Using redshift connection "master".
2018-11-26 12:19:59,877 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:19:59,939 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 12:19:59,941 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:19:59,942 (MainThread): Parsing model.elevenia_c2c.sessions_ord_test
2018-11-26 12:19:59,954 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:19:59,954 (MainThread): Using redshift connection "master".
2018-11-26 12:19:59,954 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:20:00,057 (MainThread): SQL status: SELECT in 0.10 seconds
2018-11-26 12:20:00,058 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:20:00,059 (MainThread): Parsing model.elevenia_c2c.sessions_paid
2018-11-26 12:20:00,071 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:20:00,071 (MainThread): Using redshift connection "master".
2018-11-26 12:20:00,071 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:20:00,163 (MainThread): SQL status: SELECT in 0.09 seconds
2018-11-26 12:20:00,164 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:20:00,166 (MainThread): Parsing model.elevenia_c2c.sessions_paid_test
2018-11-26 12:20:00,177 (MainThread): On "<None>": cache miss for schema "dbt_dev", this is inefficient
2018-11-26 12:20:00,177 (MainThread): Using redshift connection "master".
2018-11-26 12:20:00,177 (MainThread): On master: select tablename as name, schemaname as schema, 'table' as type from pg_tables
        where schemaname ilike 'dbt_dev'
        union all
        select viewname as name, schemaname as schema, 'view' as type from pg_views
        where schemaname ilike 'dbt_dev'
2018-11-26 12:20:00,241 (MainThread): SQL status: SELECT in 0.06 seconds
2018-11-26 12:20:00,242 (MainThread): with schema=dbt_dev, model_name=None, relations=[<DefaultRelation "dbt_dev"."sessions_dlv">, <DefaultRelation "dbt_dev"."sessions_ord_no_hr">, <DefaultRelation "dbt_dev"."ff_free_delivery_d">, <DefaultRelation "dbt_dev"."ord_no_hr">]
2018-11-26 12:20:00,243 (MainThread): Parsing model.elevenia_c2c.ff_free_delivery_d
2018-11-26 12:20:00,254 (MainThread): Parsing model.elevenia_c2c.dd_address
2018-11-26 12:20:00,266 (MainThread): Parsing model.elevenia_c2c.dd_address_v2
2018-11-26 12:20:00,276 (MainThread): Parsing model.elevenia_c2c.dd_address_v3
2018-11-26 12:20:00,288 (MainThread): Parsing model.elevenia_c2c.dd_disp_ctgr
2018-11-26 12:20:00,300 (MainThread): Parsing model.elevenia_c2c.rangga_test
2018-11-26 12:20:00,335 (MainThread): 12:20:00 | Building catalog
2018-11-26 12:20:00,383 (MainThread): Acquiring new redshift connection "get_catalog_data".
2018-11-26 12:20:00,383 (MainThread): Opening a new connection (1 currently allocated)
2018-11-26 12:20:00,384 (MainThread): Connecting to Redshift using 'database' credentials
2018-11-26 12:20:00,520 (MainThread): Using redshift connection "get_catalog_data".
2018-11-26 12:20:00,521 (MainThread): On get_catalog_data: BEGIN
2018-11-26 12:20:00,561 (MainThread): SQL status: BEGIN in 0.04 seconds
2018-11-26 12:20:00,561 (MainThread): Using redshift connection "get_catalog_data".
2018-11-26 12:20:00,561 (MainThread): On get_catalog_data: with late_binding as (
      select
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    tables as (

      select
          table_schema,
          table_name,
          table_type

      from information_schema.tables

    ),

    table_owners as (

        select
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    columns as (

        select
            table_schema,
            table_name,
            null::varchar as table_comment,

            column_name,
            ordinal_position as column_index,
            data_type as column_type,
            null::varchar as column_comment


        from information_schema.columns

    ),

    unioned as (

        select *
        from tables
        join columns using (table_schema, table_name)

        union all

        select *
        from late_binding

    )

    select *,
        table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_schema, table_name)

    where table_schema != 'information_schema'
      and table_schema not like 'pg_%'

    order by "column_index"
2018-11-26 12:20:02,513 (MainThread): SQL status: SELECT in 1.95 seconds
2018-11-26 12:20:04,085 (MainThread): Using redshift connection "get_catalog_data".
2018-11-26 12:20:04,085 (MainThread): On get_catalog_data: select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
2018-11-26 12:20:04,103 (MainThread): SQL status: SELECT in 0.02 seconds
2018-11-26 12:20:04,103 (MainThread): 

    Warning: The database user "dbt_user" has insufficient permissions to
    query the "svv_table_info" table. Please grant SELECT permissions on this table
    to the "dbt_user" user to fetch extended table details from Redshift.

    
2018-11-26 12:20:04,298 (MainThread): On get_catalog_data: ROLLBACK
2018-11-26 12:20:04,468 (MainThread): 12:20:04 | Catalog written to D:\project\elevenia_c2c\target\catalog.json
2018-11-26 12:20:04,468 (MainThread): Flushing usage events
2018-11-26 12:20:11,295 (MainThread): Tracking: do not track
2018-11-26 12:20:11,298 (MainThread): Serving docs at 0.0.0.0:8080
2018-11-26 12:20:11,298 (MainThread): To access from your browser, navigate to http://localhost:8080.
2018-11-26 12:20:11,299 (MainThread): Press Ctrl+C to exit.


2018-11-26 13:26:00,349 (MainThread): Flushing usage events
2018-11-26 13:26:00,349 (MainThread): ctrl-c
